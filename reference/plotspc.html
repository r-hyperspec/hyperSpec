<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plotting spectra — plotspc • hyperSpec</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Plotting spectra — plotspc"><meta property="og:description" content="Plot spectra of a hyperSpec object, i.e. intensity over wavelength.
Instead of the intensity values of the spectra matrix summary values
calculated from these may be used.
Calculate appropriate yoffset values for stacking in plotspc()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hyperSpec</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.200.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://r-hyperspec.github.io/hyperSpec/" class="external-link">Released</a>
    </li>
    <li>
      <a href="https://r-hyperspec.github.io/hyperSpec/dev/" class="external-link">In-development</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/hyperSpec.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/fileio.html">Import and Export Files with Spectra</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting Functions in "hyperSpec"</a>
    </li>
    <li>
      <a href="../articles/baseline.html">Fitting Baselines to Spectra</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">More articles...</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/r-hyperspec/hyperSpec/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plotting spectra</h1>
    <small class="dont-index">Source: <a href="https://github.com/r-hyperspec/hyperSpec/blob/HEAD/R/calculate_stacked_offsets.R" class="external-link"><code>R/calculate_stacked_offsets.R</code></a></small>
    <div class="hidden name"><code>plotspc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plot spectra of a <code>hyperSpec</code> object, i.e. intensity over wavelength.
Instead of the intensity values of the spectra matrix summary values
calculated from these may be used.</p>
<p>Calculate appropriate <code>yoffset</code> values for stacking in <code>plotspc()</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plotspc</span><span class="op">(</span>
  <span class="va">object</span>,
  wl.range <span class="op">=</span> <span class="cn">TRUE</span>,
  wl.index <span class="op">=</span> <span class="cn">FALSE</span>,
  wl.reverse <span class="op">=</span> <span class="cn">FALSE</span>,
  spc.nmax <span class="op">=</span> <span class="fu"><a href="options.html">hy_get_option</a></span><span class="op">(</span><span class="st">"plot.spc.nmax"</span><span class="op">)</span>,
  func <span class="op">=</span> <span class="cn">NULL</span>,
  func.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  stacked <span class="op">=</span> <span class="cn">NULL</span>,
  stacked.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  add <span class="op">=</span> <span class="cn">FALSE</span>,
  bty <span class="op">=</span> <span class="st">"l"</span>,
  plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"black"</span>,
  lines.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  xoffset <span class="op">=</span> <span class="fl">0</span>,
  yoffset <span class="op">=</span> <span class="fl">0</span>,
  nxticks <span class="op">=</span> <span class="fl">10</span>,
  axis.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  break.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  title.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  fill <span class="op">=</span> <span class="cn">NULL</span>,
  fill.col <span class="op">=</span> <span class="cn">NULL</span>,
  border <span class="op">=</span> <span class="cn">NA</span>,
  polygon.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  zeroline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">)</span>,
  debuglevel <span class="op">=</span> <span class="fu"><a href="options.html">hy_get_option</a></span><span class="op">(</span><span class="st">"debuglevel"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">stacked.offsets</span><span class="op">(</span>
  <span class="va">x</span>,
  stacked <span class="op">=</span> <span class="cn">TRUE</span>,
  min.zero <span class="op">=</span> <span class="cn">FALSE</span>,
  add.factor <span class="op">=</span> <span class="fl">0.05</span>,
  add.sum <span class="op">=</span> <span class="fl">0</span>,
  .spc <span class="op">=</span> <span class="cn">NULL</span>,
  debuglevel <span class="op">=</span> <span class="fu"><a href="options.html">hy_get_option</a></span><span class="op">(</span><span class="st">"debuglevel"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p><code>hyperSpec</code> object.</p></dd>
<dt>wl.range</dt>
<dd><p>The wavelength range to be plotted.</p>
<p>Either a numeric vector or a list of vectors with different wavelength
ranges to be plotted separately.</p>
<p>The values can be either wavelengths or wavelength indices (according to
<code>wl.index</code>).</p></dd>
<dt>wl.index</dt>
<dd><p>if <code>TRUE</code>, <code>wl.range</code> is considered to give
column indices into the spectra matrix. Defaults to specifying
wavelength values rather than indices.</p></dd>
<dt>wl.reverse</dt>
<dd><p>if <code>TRUE</code>, the wavelength axis is plotted backwards.</p></dd>
<dt>spc.nmax</dt>
<dd><p>maximal number of spectra to be plotted (to avoid
accidentally plotting of large numbers of spectra).</p></dd>
<dt>func</dt>
<dd><p>a function to apply to each wavelength in order to calculate
summary spectra such as mean, min, max, etc.</p></dd>
<dt>func.args</dt>
<dd><p><code>list</code> with further arguments for <code>func</code></p></dd>
<dt>stacked</dt>
<dd><p>if not <code>NULL</code>, a "stacked" plot is produced, see the
example. <code>stacked</code> may be <code>TRUE</code> to stack single spectra.  A
numeric or factor is interpreted as giving the grouping, character is
interpreted as the name of the extra data column that holds the groups.</p></dd>
<dt>stacked.args</dt>
<dd><p>a list with further arguments to <code>stacked.offsets()</code>.</p></dd>
<dt>add</dt>
<dd><p>if <code>TRUE</code>, the output is added to the existing plot</p></dd>
<dt>bty</dt>
<dd><p>see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">graphics::par()</a></code></p></dd>
<dt>plot.args</dt>
<dd><p><code>list</code> with further arguments to <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">graphics::plot()</a></code>.</p></dd>
<dt>col</dt>
<dd><p>see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">graphics::par()</a></code>. <code>col</code> might be a vector giving individual
colors for the spectra.</p></dd>
<dt>lines.args</dt>
<dd><p>list with further arguments to <code><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">graphics::lines()</a></code>.</p>
<p><code>lines.args$type</code> defaults to <code>"l"</code>.</p></dd>
<dt>xoffset</dt>
<dd><p>vector with abscissa offsets for each of the <code>wl.range</code>s.
If it has one element less than there are <code>wl.range</code>s, 0 is padded
at the beginning.</p>
<p>The values are interpreted as the distance along the wavelength axis that
the following parts of the spectra are shifted towards the origin.
E.g. if <code>wl.range = list(600 ~ 1800, 2800 ~ 3200)</code>, <code>xoffset = 750</code>
would result in a reasonable plot. See also the examples.</p></dd>
<dt>yoffset</dt>
<dd><p>ordinate offset values for the spectra. May be offsets to
stack the spectra (<code>stacked.offsets()</code>). Either one for all
spectra, one per spectrum or one per group in <code>stacked</code>.</p></dd>
<dt>nxticks</dt>
<dd><p>hint how many tick marks the abscissa should have.</p></dd>
<dt>axis.args</dt>
<dd><p><code>list</code> with further arguments for <code><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">graphics::axis()</a></code>.
<code>axis.args$x</code> should contain arguments for plotting the abscissa,
<code>axis.args$y</code> those for the ordinate (again as <code>lists</code>).</p></dd>
<dt>break.args</dt>
<dd><p>list with arguments for <code><a href="https://rdrr.io/pkg/plotrix/man/axis.break.html" class="external-link">plotrix::axis.break()</a></code>.</p></dd>
<dt>title.args</dt>
<dd><p>list with further arguments to <code><a href="https://rdrr.io/r/graphics/title.html" class="external-link">graphics::title()</a></code>.</p>
<p><code>title.args</code> may contain two lists, <code>$x</code>, and <code>$y</code> to set parameters
individually for each axis.</p></dd>
<dt>fill</dt>
<dd><p>if not <code>NULL</code>, the area between the specified spectra is
filled with color <code>col</code>. The grouping can be given as factor or
numeric, or as a character with the name of the extra data column
to use. If a group contains more than 2 spectra, the first and the
last are used.</p>
<p>If <code>TRUE</code> spectra n and nrow (spc) - n build a group.</p></dd>
<dt>fill.col</dt>
<dd><p>character vector with fill color. Defaults to brightened
colors from <code>col</code>.</p></dd>
<dt>border</dt>
<dd><p>character vector with border color. You will need to set the
line color <code>col</code> to <code>NA</code> in order see the effect.</p></dd>
<dt>polygon.args</dt>
<dd><p>list with further arguments to <code><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">graphics::polygon()</a></code>,
which draws the filled areas.</p></dd>
<dt>zeroline</dt>
<dd><p><code>NA</code> or a list with arguments <code><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">graphics::abline()</a></code>, used
to plot line(s) marking <code>I = 0</code>.</p>
<p><code>NA</code> suppresses plotting of the line.  The line is by default turned
off if <code>yoffset</code> is not 0.</p></dd>
<dt>debuglevel</dt>
<dd><p>if &gt; 0, additional debug output is produced, see
<code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code> for details.</p></dd>
<dt>x</dt>
<dd><p><code>hyperSpec</code> object.</p></dd>
<dt>min.zero</dt>
<dd><p>If <code>TRUE</code>, the lesser of zero and the minimum intensity of
the spectrum is used as minimum.</p></dd>
<dt>add.factor, add.sum</dt>
<dd><p>proportion and absolute amount of space that
should be added.</p></dd>
<dt>.spc</dt>
<dd><p>for internal use. If given, the ranges are evaluated on <code>.spc</code>.
However, this may change in future.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>plotspc</code> invisibly returns a list with:</p>
<dl><dt>x</dt>
<dd><p>the abscissa coordinates of the plotted spectral data points</p></dd>
<dt>y</dt>
<dd><p>a matrix the ordinate coordinates of the plotted spectral data
points</p></dd>
<dt>wavelengths</dt>
<dd><p>the wavelengths of the plotted spectral data points</p></dd>
</dl><p>This can be used together with <code><a href="identify_spc.html">identify_spc()</a></code>.
a list containing</p>
<dl><dt>offsets</dt>
<dd><p>numeric with the yoffset for each group in <code>stacked</code></p></dd>
<dt>groups</dt>
<dd><p>numeric with the group number for each spectrum</p></dd>
<dt>levels</dt>
<dd><p>if <code>stacked</code> is a factor, the levels of the groups</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This is <code>hyperSpec</code>'s main plotting function for spectra plots.</p>
<p>New plots are created by <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">graphics::plot()</a></code>, but the abscissa and
ordinate are drawn separately by <code><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">graphics::axis()</a></code>. Also,
<code><a href="https://rdrr.io/r/graphics/title.html" class="external-link">graphics::title()</a></code> is called explicitly to set up titles and
axis labels. This allows fine-grained customization of the plots.</p>
<p>If package plotrix is available, its function
<code><a href="https://rdrr.io/pkg/plotrix/man/axis.break.html" class="external-link">plotrix::axis.break()</a></code> is used to produce break marks for cut
wavelength axes.</p>
<p>Usually, the <code>stacked</code> argument of <code>plotspc()</code> will do fine, but
if you need fine control over the stacking, you may calculate the y offsets
yourself.</p>
<p>Empty levels of the stacking factor are dropped (as no stacking offset can
be calculated in that case.)</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">graphics::plot()</a></code>, <code><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">graphics::axis()</a></code>, <code><a href="https://rdrr.io/r/graphics/title.html" class="external-link">graphics::title()</a></code>,
<code><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">graphics::lines()</a></code>, <code><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">graphics::polygon()</a></code>, <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">graphics::par()</a></code>
for the description of the respective arguments;</p>
<p><code><a href="https://rdrr.io/pkg/plotrix/man/axis.break.html" class="external-link">plotrix::axis.break()</a></code> for cut marks;</p>
<p>See <code><a href="plot.html">plot()</a></code> for some predefined spectra plots such as mean spectrum +/- one
standard deviation and the like.</p>
<p><code><a href="https://rdrr.io/r/graphics/identify.html" class="external-link">graphics::identify()</a></code> and <code><a href="https://rdrr.io/r/graphics/locator.html" class="external-link">graphics::locator()</a></code> about interaction with plots.</p>
<p><code>plotspc()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>C. Beleites</p>
<p>C. Beleites</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu">plotspc</span><span class="op">(</span><span class="va">flu</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plotspc-1.png" alt="" width="466" height="288"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Artificial example to show wavelength axis cutting</span></span>
<span class="r-in"><span class="fu">plotspc</span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span><span class="fu"><a href="sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">)</span>, <span class="fl">50</span><span class="op">)</span><span class="op">]</span>,</span>
<span class="r-in">  wl.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">600</span> <span class="op">~</span> <span class="fl">650</span>, <span class="fl">1000</span> <span class="op">~</span> <span class="fl">1100</span>, <span class="fl">1600</span> <span class="op">~</span> <span class="fl">1700</span><span class="op">)</span>,</span>
<span class="r-in">  xoffset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">300</span>, <span class="fl">450</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="plotspc-2.png" alt="" width="466" height="288"></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">plotspc</span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span><span class="fu"><a href="sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">)</span>, <span class="fl">50</span><span class="op">)</span><span class="op">]</span>,</span>
<span class="r-in">  wl.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">600</span> <span class="op">~</span> <span class="fl">650</span>, <span class="fl">1000</span> <span class="op">~</span> <span class="fl">1100</span>, <span class="fl">1600</span> <span class="op">~</span> <span class="fl">1700</span><span class="op">)</span>,</span>
<span class="r-in">  xoffset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">450</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="plotspc-3.png" alt="" width="466" height="288"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## some journals publish Raman spectra backwards</span></span>
<span class="r-in"><span class="fu">plotspc</span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span><span class="fu"><a href="sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">)</span>, <span class="fl">50</span><span class="op">)</span><span class="op">]</span>, wl.reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plotspc-4.png" alt="" width="466" height="288"></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">plotspc</span><span class="op">(</span><span class="va">laser</span><span class="op">[</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">*</span> <span class="fl">20</span> <span class="op">+</span> <span class="fl">1</span>, , <span class="op">]</span>, stacked <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plotspc-5.png" alt="" width="466" height="288"></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">plotspc</span><span class="op">(</span><span class="va">laser</span>,</span>
<span class="r-in">  func <span class="op">=</span> <span class="va">mean_pm_sd</span>,</span>
<span class="r-in">  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span>, lines.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span class="r-in">  fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span class="r-in">  fill.col <span class="op">=</span> <span class="st">"yellow"</span>, border <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span class="r-in">  polygon.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span class="r-in">  title.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">[</span><span class="va">emission</span><span class="op">]</span> <span class="op">/</span> <span class="va">nm</span><span class="op">)</span>,</span>
<span class="r-in">    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>line <span class="op">=</span> <span class="fl">3.4</span><span class="op">)</span>,</span>
<span class="r-in">    col.lab <span class="op">=</span> <span class="st">"darkgreen"</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  axis.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="plotspc-6.png" alt="" width="466" height="288"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">fc_mean_pm_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">faux_cell</span>, <span class="va">faux_cell</span><span class="op">$</span><span class="va">region</span>, <span class="va">mean_pm_sd</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">fc_mean_pm_sd</span>, col <span class="op">=</span> <span class="fu"><a href="palettes.html">palette_matlab</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">".aggregate"</span>, stacked <span class="op">=</span> <span class="st">".aggregate"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plotspc-7.png" alt="" width="466" height="288"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">fc_mean_pm_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">faux_cell</span>, <span class="va">faux_cell</span><span class="op">$</span><span class="va">region</span>, <span class="va">mean_pm_sd</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">offset</span> <span class="op">&lt;-</span> <span class="fu">stacked.offsets</span><span class="op">(</span><span class="va">fc_mean_pm_sd</span>, <span class="st">".aggregate"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">fc_mean_pm_sd</span>,</span>
<span class="r-in">  fill.col <span class="op">=</span> <span class="fu"><a href="palettes.html">palette_matlab</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">".aggregate"</span>,</span>
<span class="r-in">  stacked <span class="op">=</span> <span class="st">".aggregate"</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">faux_cell</span>, <span class="va">faux_cell</span><span class="op">$</span><span class="va">region</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span class="r-in">  yoffset <span class="op">=</span> <span class="va">offset</span><span class="op">$</span><span class="va">offsets</span>,</span>
<span class="r-in">  lines.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="plotspc-8.png" alt="" width="466" height="288"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">barb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">collapse</span>, <span class="va">barbiturates</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">barb</span>,</span>
<span class="r-in">  lines.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"h"</span><span class="op">)</span>, stacked <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">  stacked.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>add.factor <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="plotspc-9.png" alt="" width="466" height="288"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Claudia Beleites, <a href="https://orcid.org/0000-0002-9500-5167" class="external-link">Vilmantas Gegzna</a>, <a href="http://academic.depauw.edu/hanson_web/" class="external-link">Bryan A. Hanson</a>, Roman Kiselev, Erick Oduniyi, Valter Sergo.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

