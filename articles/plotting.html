<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting Functions in "hyperSpec" • hyperSpec</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Plotting Functions in " hyperspec>
<meta property="og:description" content="plotting: Manual of hyperSpec's plotting functions">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hyperSpec</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.200.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://r-hyperspec.github.io/hyperSpec/" class="external-link">Released</a>
    </li>
    <li>
      <a href="https://r-hyperspec.github.io/hyperSpec/dev/" class="external-link">In-development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/hyperSpec.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fileio.html">Import and Export Files with Spectra</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting Functions in "hyperSpec"</a>
    </li>
    <li>
      <a href="../articles/baseline.html">Fitting Baselines to Spectra</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../articles/index.html">More articles...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-hyperspec/hyperSpec/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Plotting Functions in “hyperSpec”</h1>
                        <h4 data-toc-skip class="author">Claudia Beleites<sup>1,2,3,4,5</sup>, Vilmantas Gegzna</h4>
            <address class="author_afil">
      <ol style="list-style-type: decimal">
<li>DIA Raman Spectroscopy Group, University of Trieste/Italy (2005–2008)</li>
      <li>Spectroscopy <span class="math inline">\(\cdot\)</span> Imaging, IPHT, Jena/Germany (2008–2017)</li>
      <li>ÖPV, JKI, Berlin/Germany (2017–2019)</li>
      <li>Arbeitskreis Lebensmittelmikrobiologie und Biotechnologie, Hamburg University, Hamburg/Germany (2019 – 2020)</li>
      <li>Chemometric Consulting and Chemometrix GmbH, Wölfersheim/Germany (since 2016)</li>
      </ol>
<br><a class="author_email" href="mailto:#"></a><a href="mailto:chemometrie@beleites.de" class="email">chemometrie@beleites.de</a>
      </address>
                  
            <h4 data-toc-skip class="date">2021-12-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-hyperspec/hyperSpec/blob/HEAD/vignettes/plotting.Rmd" class="external-link"><code>vignettes/plotting.Rmd</code></a></small>
      <div class="hidden name"><code>plotting.Rmd</code></div>

    </div>

    
    
<pre><code><span class="co">#&gt; tweaking rgl</span></code></pre>
<div class="section level1 unnumbered">
<h1 id="suggested-packages-and-setup">Suggested Packages and Setup<a class="anchor" aria-label="anchor" href="#suggested-packages-and-setup"></a>
</h1>
<div class="note">
<p>
<strong>Reproducing the examples in this vignette.</strong>
</p>
<p>
All spectra used in this manual are installed automatically with package <strong>hyperSpec</strong>.
</p>
</div>
<hr>
<blockquote>
<p><strong>Terminology</strong>
Throughout the documentation of the package, the following terms are used:</p>
<ul>
<li>
<strong>wavelength</strong> indicates any type of spectral abscissa.</li>
<li>
<strong>intensity</strong> indicates any type of spectral ordinate.</li>
<li>
<strong>extra data</strong> indicates non-spectroscopic data.</li>
</ul>
</blockquote>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-hyperspec.github.io/hyperSpec" class="external-link">hyperSpec</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://latticeextra.r-forge.r-project.org/" class="external-link">latticeExtra</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">deldir</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="co"># library(rgl)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">1</span>, <span class="fl">.6</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></code></pre></div>
<p>Besides, package <strong>tripack</strong><span class="citation">[<a href="#ref-R-tripack" role="doc-biblioref">1</a>]</span> is mentioned, but not used in this vignette.</p>
</div>
<div class="section level1 unnumbered">
<h1 id="preliminary-calculations">Preliminary Calculations<a class="anchor" aria-label="anchor" href="#preliminary-calculations"></a>
</h1>
<p>For some plots of the <code class="sourceCode r">faux_cell</code> dataset, the pre-processed spectra and their cluster averages <span class="math inline">\(\pm\)</span> one standard deviation are more suitable:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">faux_cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/faux_cell.html">generate_faux_cell</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">faux_cell_preproc</span> <span class="op">&lt;-</span> <span class="va">faux_cell</span> <span class="op">-</span> <span class="fu"><a href="../reference/baselines.html">spc_fit_poly_below</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">)</span>
<span class="va">faux_cell_preproc</span> <span class="op">&lt;-</span> <span class="va">faux_cell_preproc</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">)</span>
<span class="va">faux_cell_preproc</span> <span class="op">&lt;-</span> <span class="va">faux_cell_preproc</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">faux_cell_preproc</span>, <span class="fl">0.05</span><span class="op">)</span>

<span class="va">cluster_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dark blue"</span>, <span class="st">"orange"</span>, <span class="st">"#C02020"</span><span class="op">)</span>
<span class="va">cluster_meansd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">faux_cell_preproc</span>, <span class="va">faux_cell</span><span class="op">$</span><span class="va">region</span>, <span class="va">mean_pm_sd</span><span class="op">)</span>
<span class="va">cluster_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">faux_cell_preproc</span>, <span class="va">faux_cell</span><span class="op">$</span><span class="va">region</span>, <span class="va">mean</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="predefined-functions">
<span class="header-section-number">1</span> Predefined Functions<a class="anchor" aria-label="anchor" href="#predefined-functions"></a>
</h1>
<p>Package <strong>hyperSpec</strong> comes with 6 major predefined plotting functions:</p>
<dl>
<dt><strong><code class="sourceCode r"><span class="kw">plot</span>()</code></strong></dt>
<dd>main switchyard for most plotting tasks.
More details in section <a href="#fun-plot">2</a>.
</dd>
<dt><strong><code class="sourceCode r"><span class="kw">plotspc</span>()</code></strong></dt>
<dd>plots spectra.
More details in sections <a href="#exm-plotspc">1.1</a>, <a href="#arg-spc">2.1</a>, and <a href="#fun-plotspc">3</a>.
</dd>
<dt><strong><code class="sourceCode r"><span class="kw">plotc</span>()</code></strong></dt>
<dd>calibration plot, time series, depth profile.
More details in sections <a href="#exm-plotc">1.3</a>, <a href="#arg-c">2.5</a>, <a href="#arg-ts">2.6</a>, <a href="#arg-depth">2.7</a>, and <a href="#fun-plotc">4</a>.
(<code class="sourceCode r"><span class="kw">plotc</span>()</code> is a package <strong>lattice</strong> function)
</dd>
<dt><strong><code class="sourceCode r"><span class="kw">levelplot</span>()</code></strong></dt>
<dd>package <strong>hyperSpec</strong> has a method for package <strong>lattice</strong><span class="citation">[<a href="#ref-R-lattice" role="doc-biblioref">2</a>,<a href="#ref-lattice2008" role="doc-biblioref">3</a>]</span> function <code class="sourceCode r"><span class="kw">levelplot</span>()</code>.
More details in sections <a href="#exm-levelplot">1.4</a>, and <a href="#fun-levelplot">5</a>.
</dd>
<dt><strong><code class="sourceCode r"><span class="kw">plotmat</span>()</code></strong></dt>
<dd>plots the spectra matrix.
More details in sections <a href="#exm-plotmat">1.2</a>, <a href="#arg-mat">2.8</a>, and <a href="#fun-plotmat">6</a>.
</dd>
<dt><strong><code class="sourceCode r"><span class="kw">plotmap</span>()</code></strong></dt>
<dd>more specialized version of <code class="sourceCode r"><span class="kw">levelplot</span>()</code> for map or image plots.
More details in sections <a href="#exm-plotmap">1.5</a>, <a href="#arg-map">2.9</a>, and <a href="#fun-plotmap">7</a>.
(<code class="sourceCode r"><span class="kw">plotmap</span>()</code> is a package <strong>lattice</strong> function)
</dd>
<dt><strong><code class="sourceCode r"><span class="kw">plotvoronoi</span>()</code></strong></dt>
<dd>more specialized version of <code class="sourceCode r"><span class="kw">plotmap</span>()</code> that produces Voronoi tesselations.
More details in sections <a href="#exm-plotvoronoi">1.6</a>, and <a href="#arg-voronoi">2.10</a>.
(<code class="sourceCode r"><span class="kw">plotvoronoi</span>()</code> is a package <strong>lattice</strong> function)
</dd>
</dl>
<div class="note">
<p>
<strong>NOTE.</strong> Functions <code class="sourceCode r"><span class="kw">plotmap</span>()</code>, <code class="sourceCode r"><span class="kw">plotvoronoi</span>()</code>, and <code class="sourceCode r"><span class="kw">levelplot</span>()</code> are package <strong>lattice</strong> functions. Therefore, in loops, functions, R Markdown chunks, etc. lattice objects need to be printed explicitly by, e.g., <code class="sourceCode r"><span class="kw">print</span>(<span class="kw">plotmap</span>(object))</code> (<a href="http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-do-lattice_002ftrellis-graphics-not-work_003f" class="external-link">R FAQ: Why do lattice/trellis graphics not work?</a>).
</p>
</div>
<div class="section level2">
<h2 id="exm-plotspc">
<span class="header-section-number">1.1</span> Function <code class="sourceCode r"><span class="kw">plotspc</span>()</code><a class="anchor" aria-label="anchor" href="#exm-plotspc"></a>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotspc</span>()</code> plots the spectra (Fig. <a href="#fig:plotspc">1.1</a>), i.e., the intensities (<code class="sourceCode r"><span class="op">$</span>spc</code>) over the wavelengths (<code class="sourceCode r"><span class="op">@</span>wavelength</code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotspc.html">plotspc</a></span><span class="op">(</span><span class="va">flu</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotspc"></span>
<img src="plotting_files/figure-html/plotspc-1.png" alt="Spectra in dataset `flu`.  "><p class="caption">
Figure 1.1: Spectra in dataset <code>flu</code>.
</p>
</div>
</div>
<div class="section level2">
<h2 id="exm-plotmat">
<span class="header-section-number">1.2</span> Function <code class="sourceCode r"><span class="kw">plotmat</span>()</code><a class="anchor" aria-label="anchor" href="#exm-plotmat"></a>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotmat</span>()</code> plots the spectra, i.e., the colour coded intensities (<code class="sourceCode r"><span class="op">$</span>spc</code>) over the wavelengths (<code class="sourceCode r"><span class="op">@</span>wavelength</code>) and the row number (Fig. <a href="#fig:plotmat-flu">1.2</a>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotmat.html">plotmat</a></span><span class="op">(</span><span class="va">flu</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmat-flu"></span>
<img src="plotting_files/figure-html/plotmat-flu-1.png" alt="Matrix of spectra: the colour coded intensities over the wavelengths and the row number.  "><p class="caption">
Figure 1.2: Matrix of spectra: the colour coded intensities over the wavelengths and the row number.
</p>
</div>
</div>
<div class="section level2">
<h2 id="exm-plotc">
<span class="header-section-number">1.3</span> Function <code class="sourceCode r"><span class="kw">plotc</span>()</code><a class="anchor" aria-label="anchor" href="#exm-plotc"></a>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotc</span>()</code> plots an intensity over a single other data column, e.g., concentration (calibration plot, e.g., Fig. <a href="#fig:plotflu">1.3</a>), depth (depth profile plot), or time (time series plot).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotc.html">plotc</a></span><span class="op">(</span><span class="va">flu</span><span class="op">)</span>
<span class="co">#&gt; Warning in plotc(flu): Intensity at first wavelengh only is used.</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotflu"></span>
<img src="plotting_files/figure-html/plotflu-1.png" alt="Calibration plot: an intensity over concentration.  "><p class="caption">
Figure 1.3: Calibration plot: an intensity over concentration.
</p>
</div>
<blockquote>
<p>The following warning is expected: <code>Intensity at first wavelengh only is used.</code></p>
</blockquote>
</div>
<div class="section level2">
<h2 id="exm-levelplot">
<span class="header-section-number">1.4</span> Function <code class="sourceCode r"><span class="kw">levelplot</span>()</code><a class="anchor" aria-label="anchor" href="#exm-levelplot"></a>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">levelplot</span>()</code> plots a false colour map, defined by a formula (Fig. <a href="#fig:levelplot">5.1</a>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/levelplot.html" class="external-link">levelplot</a></span><span class="op">(</span><span class="va">spc</span> <span class="op">~</span> <span class="va">x</span> <span class="op">*</span> <span class="va">y</span>, <span class="va">faux_cell</span><span class="op">[</span>, , <span class="fl">1200</span><span class="op">]</span>, aspect <span class="op">=</span> <span class="st">"iso"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:levelplot-1"></span>
<img src="plotting_files/figure-html/levelplot-1-1.png" alt="False colour map (1).  "><p class="caption">
Figure 1.4: False colour map (1).
</p>
</div>
<blockquote>
<p>The following warning is expected: <code>Only first wavelength is used for plotting</code>.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="exm-plotmap">
<span class="header-section-number">1.5</span> Function <code class="sourceCode r"><span class="kw">plotmap</span>()</code><a class="anchor" aria-label="anchor" href="#exm-plotmap"></a>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotmap</span>()</code> is a specialized version of <code class="sourceCode r"><span class="kw">levelplot</span>()</code>.
It uses a single value (e.g., average intensity or cluster membership) over two data columns (default are <code class="sourceCode r"><span class="op">$</span>x</code> and <code class="sourceCode r"><span class="op">$</span>y</code>) to plot a false colour map (Fig. <a href="#fig:plotmap">1.5</a>).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">plotmap</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span>, , <span class="fl">1200</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmap"></span>
<img src="plotting_files/figure-html/plotmap-1.png" alt="False colour map created with `plotmap()`{.r}.  "><p class="caption">
Figure 1.5: False colour map created with <code class="sourceCode r"><span class="kw">plotmap</span>()</code>.
</p>
</div>
</div>
<div class="section level2">
<h2 id="exm-plotvoronoi">
<span class="header-section-number">1.6</span> Function <code class="sourceCode r"><span class="kw">plotvoronoi</span>()</code><a class="anchor" aria-label="anchor" href="#exm-plotvoronoi"></a>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotvoronoi</span>()</code> is a special version of <code class="sourceCode r"><span class="kw">plotmap</span>()</code> that produces Voronoi diagram of the <code>hyperSpec</code> object (Fig. <a href="#fig:voronoi">1.6</a>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">plotvoronoi</a></span><span class="op">(</span><span class="fu"><a href="../reference/sample.html">sample</a></span><span class="op">(</span><span class="va">faux_cell</span>, <span class="fl">300</span><span class="op">)</span>, <span class="va">region</span> <span class="op">~</span> <span class="va">x</span> <span class="op">*</span> <span class="va">y</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:voronoi"></span>
<img src="plotting_files/figure-html/voronoi-1.png" alt="Voronoi diagram: an example with `faux_cell` dataset.  "><p class="caption">
Figure 1.6: Voronoi diagram: an example with <code>faux_cell</code> dataset.
</p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="fun-plot">
<span class="header-section-number">2</span> Arguments for <code class="sourceCode r"><span class="kw">plot</span>()</code><a class="anchor" aria-label="anchor" href="#fun-plot"></a>
</h1>
<p>The <strong>hyperSpec</strong>’s <code class="sourceCode r"><span class="kw">plot</span>()</code> method uses its second argument to determine which of the specialized plots to produce.
This allows some handy abbreviations.
All further arguments are handed over to the function actually producing the plot.</p>
<div class="section level2">
<h2 id="arg-spc">
<span class="header-section-number">2.1</span> Argument <code class="sourceCode r"><span class="st">"spc"</span></code><a class="anchor" aria-label="anchor" href="#arg-spc"></a>
</h2>
<p>Command <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"spc"</span>)</code> is equivalent to <code class="sourceCode r"><span class="kw">plotspc</span>(flu)</code> (Fig. <a href="#fig:plotspcflu">2.1</a>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">flu</span>, <span class="st">"spc"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotspcflu"></span>
<img src="plotting_files/figure-html/plotspcflu-1.png" alt="All spectra of dataset `flu`.  "><p class="caption">
Figure 2.1: All spectra of dataset <code>flu</code>.
</p>
</div>
</div>
<div class="section level2">
<h2 id="arg-spcmeansd">
<span class="header-section-number">2.2</span> Argument <code class="sourceCode r"><span class="st">"spcmeansd"</span></code><a class="anchor" aria-label="anchor" href="#arg-spcmeansd"></a>
</h2>
<p>Command <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"spcmeansd"</span>)</code> plots mean spectrum <span class="math inline">\(\pm\)</span> 1 standard deviation (Fig. <a href="#fig:plotchomean">2.2</a>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">faux_cell_preproc</span>, <span class="st">"spcmeansd"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotchomean"></span>
<img src="plotting_files/figure-html/plotchomean-1.png" alt="Summary spectra: mean $\pm$ one standard deviation at each wavelength (wavenumber).  "><p class="caption">
Figure 2.2: Summary spectra: mean <span class="math inline">\(\pm\)</span> one standard deviation at each wavelength (wavenumber).
</p>
</div>
</div>
<div class="section level2">
<h2 id="arg-spcprctile">
<span class="header-section-number">2.3</span> Argument <code class="sourceCode r"><span class="st">"spcprctile"</span></code><a class="anchor" aria-label="anchor" href="#arg-spcprctile"></a>
</h2>
<p>Code <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"spcprctile"</span>)</code> plots median, 16<sup>th</sup> and 84<sup>th</sup> percentile for each wavelength (Fig. <a href="#fig:plotchoprctl">2.3</a>).
For Gaussian distributed data, 16<sup>th</sup>, 50<sup>th</sup> and 84<sup>th</sup> percentile are equal to mean <span class="math inline">\(\pm\)</span> standard deviation.
Spectroscopic data frequently are not Gaussian distributed.
The percentiles give a better idea of the true distribution.
They are also less sensitive to outliers.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">faux_cell_preproc</span>, <span class="st">"spcprctile"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotchoprctl"></span>
<img src="plotting_files/figure-html/plotchoprctl-1.png" alt="Summary spectra: median, 16^th^ and 84^th^ percentiles at each wavelength (wavenumber).  "><p class="caption">
Figure 2.3: Summary spectra: median, 16<sup>th</sup> and 84<sup>th</sup> percentiles at each wavelength (wavenumber).
</p>
</div>
</div>
<div class="section level2">
<h2 id="arg-spcprctl5">
<span class="header-section-number">2.4</span> Argument <code class="sourceCode r"><span class="st">"spcprctl5"</span></code><a class="anchor" aria-label="anchor" href="#arg-spcprctl5"></a>
</h2>
<p>The code <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"spcprctl5"</span>)</code> is like <code class="sourceCode r"><span class="st">"spcprctile"</span></code> plus 5<sup>th</sup> and 95<sup>th</sup> percentile (Fig. <a href="#fig:plotchoprctl5">2.4</a>).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">faux_cell_preproc</span>, <span class="st">"spcprctl5"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotchoprctl5"></span>
<img src="plotting_files/figure-html/plotchoprctl5-1.png" alt="Summary spectra: median, 5^th^, 16^th^, 84^th^, 95^th^ percentiles at each wavelength (wavenumber).  "><p class="caption">
Figure 2.4: Summary spectra: median, 5<sup>th</sup>, 16<sup>th</sup>, 84<sup>th</sup>, 95<sup>th</sup> percentiles at each wavelength (wavenumber).
</p>
</div>
</div>
<div class="section level2">
<h2 id="arg-c">
<span class="header-section-number">2.5</span> Argument <code class="sourceCode r"><span class="st">"c"</span></code><a class="anchor" aria-label="anchor" href="#arg-c"></a>
</h2>
<p>Command <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"c"</span>)</code> is equivalent to <code class="sourceCode r"><span class="kw">plotc</span>(flu)</code> (Fig. <a href="#fig:plotflu2">2.5</a>).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">flu</span>, <span class="st">"c"</span><span class="op">)</span>
<span class="co">#&gt; Warning in plotc(x, ...): Intensity at first wavelengh only is used.</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotflu2"></span>
<img src="plotting_files/figure-html/plotflu2-1.png" alt="Calibration plot: spectra intensities over concentration.  "><p class="caption">
Figure 2.5: Calibration plot: spectra intensities over concentration.
</p>
</div>
</div>
<div class="section level2">
<h2 id="arg-ts">
<span class="header-section-number">2.6</span> Argument <code class="sourceCode r"><span class="st">"ts"</span></code><a class="anchor" aria-label="anchor" href="#arg-ts"></a>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"ts"</span>)</code> plots a time series plot and is equivalent to <code class="sourceCode r"><span class="kw">plotc</span>(laser, spc <span class="op">~</span><span class="st"> </span>t)</code> (Fig. <a href="#fig:plotts">2.6</a>).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">laser</span><span class="op">[</span>, , <span class="fl">405</span><span class="op">]</span>, <span class="st">"ts"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotts"></span>
<img src="plotting_files/figure-html/plotts-1.png" alt="Time series plot: spectra intensities over time.  "><p class="caption">
Figure 2.6: Time series plot: spectra intensities over time.
</p>
</div>
</div>
<div class="section level2">
<h2 id="arg-depth">
<span class="header-section-number">2.7</span> Argument <code class="sourceCode r"><span class="st">"depth"</span></code><a class="anchor" aria-label="anchor" href="#arg-depth"></a>
</h2>
<p>Code <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"depth"</span>)</code> plots a depth profile plot and is the same as <code class="sourceCode r"><span class="kw">plotc</span>(laser, spc <span class="op">~</span><span class="st"> </span>z)</code> (Fig. <a href="#fig:plotdepth">2.7</a>).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">depth.profile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/initialize.html">new</a></span><span class="op">(</span><span class="st">"hyperSpec"</span>,
  spc <span class="op">=</span> <span class="fu"><a href="../reference/asdataframe.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>,
  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>z <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    spc <span class="op">=</span> <span class="st">"I / a.u."</span>,
    z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">`/`</span><span class="op">(</span><span class="va">z</span>, <span class="va">mu</span> <span class="op">*</span> <span class="va">m</span><span class="op">)</span><span class="op">)</span>,
    .wavelength <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">depth.profile</span>, <span class="st">"depth"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotdepth"></span>
<img src="plotting_files/figure-html/plotdepth-1.png" alt="Depth profile plot.  "><p class="caption">
Figure 2.7: Depth profile plot.
</p>
</div>
</div>
<div class="section level2">
<h2 id="arg-mat">
<span class="header-section-number">2.8</span> Argument <code class="sourceCode r"><span class="st">"mat"</span></code><a class="anchor" aria-label="anchor" href="#arg-mat"></a>
</h2>
<p>Code <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"mat"</span>)</code> plots the spectra matrix (Fig. <a href="#fig:plotmat">2.8</a>).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">laser</span>, <span class="st">"mat"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmat"></span>
<img src="plotting_files/figure-html/plotmat-1.png" alt="Spectra matrix.  "><p class="caption">
Figure 2.8: Spectra matrix.
</p>
</div>
<p>The code is equivalent to:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotmat.html">plotmat</a></span><span class="op">(</span><span class="va">laser</span><span class="op">)</span></code></pre></div>
<p>A <strong>lattice</strong> alternative is:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/levelplot.html" class="external-link">levelplot</a></span><span class="op">(</span><span class="va">spc</span> <span class="op">~</span> <span class="va">.wavelength</span> <span class="op">*</span> <span class="va">.row</span>, data <span class="op">=</span> <span class="va">laser</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="arg-map">
<span class="header-section-number">2.9</span> Argument <code class="sourceCode r"><span class="st">"map"</span></code><a class="anchor" aria-label="anchor" href="#arg-map"></a>
</h2>
<p>Code <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"map"</span>)</code> is equivalent to <code class="sourceCode r"><span class="kw">plotmap</span>(faux_cell)</code> (Fig. <a href="#fig:plotmapcho2">2.9</a>).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span>, , <span class="fl">1200</span><span class="op">]</span>, <span class="st">"map"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmapcho2"></span>
<img src="plotting_files/figure-html/plotmapcho2-1.png" alt="False color map: alternative R syntax.   "><p class="caption">
Figure 2.9: False color map: alternative R syntax.
</p>
</div>
</div>
<div class="section level2">
<h2 id="arg-voronoi">
<span class="header-section-number">2.10</span> Argument <code class="sourceCode r"><span class="st">"voronoi"</span></code><a class="anchor" aria-label="anchor" href="#arg-voronoi"></a>
</h2>
<p>Use <code class="sourceCode r"><span class="kw">plot</span>(x, <span class="st">"voronoi"</span>)</code> for a Voronoi plot (Fig. <a href="#fig:plotvoronoi">2.10</a>).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/sample.html">sample</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span>, , <span class="fl">1200</span><span class="op">]</span>, <span class="fl">300</span><span class="op">)</span>, <span class="st">"voronoi"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotvoronoi"></span>
<img src="plotting_files/figure-html/plotvoronoi-1.png" alt="Voronoi plot: alternative R syntax.  "><p class="caption">
Figure 2.10: Voronoi plot: alternative R syntax.
</p>
</div>
<p>See <code class="sourceCode r"><a href="../reference/levelplot.html">?plotvoronoi</a></code> and <code class="sourceCode r">?latticeExtra<span class="op">::</span>panel.voronoi</code>.</p>
</div>
</div>
<div class="section level1">
<h1 id="fun-plotspc">
<span class="header-section-number">3</span> Customized Plots of Spectra: <code class="sourceCode r"><span class="kw">plotspc</span>()</code><a class="anchor" aria-label="anchor" href="#fun-plotspc"></a>
</h1>
<!-- \mFun{`plotspc()`{.r}} -->
<p>Function <code class="sourceCode r"><span class="kw">plotspc</span>()</code> offers a variety of parameters for customized plots.</p>
<div class="section level2">
<h2 id="plot-particular-wavelength-range">
<span class="header-section-number">3.1</span> Plot Particular Wavelength Range<a class="anchor" aria-label="anchor" href="#plot-particular-wavelength-range"></a>
</h2>
<p>If only one wavelength range is needed (Fig. <a href="#fig:wavelength">3.1</a>), the extract command is handiest.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotspc.html">plotspc</a></span><span class="op">(</span><span class="va">paracetamol</span><span class="op">[</span>, , <span class="fl">700</span> <span class="op">~</span> <span class="fl">1200</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:wavelength"></span>
<img src="plotting_files/figure-html/wavelength-1.png" alt="Plot of wavelength (wavenumber) range from 700 to 1200 $cm^{-1}.$  "><p class="caption">
Figure 3.1: Plot of wavelength (wavenumber) range from 700 to 1200 <span class="math inline">\(cm^{-1}.\)</span>
</p>
</div>
<p>Numbers connected with the tilde (<code>~</code>) are interpreted as having the same units as the wavelengths.
If <code class="sourceCode r">wl.range</code> already contains indices use <code class="sourceCode r">wl.index =<span class="st"> </span><span class="ot">TRUE</span></code>.
For more details refer to <code class="sourceCode r"><span class="kw">vignette</span>(<span class="st">"hyperspec"</span>, <span class="dt">package =</span> <span class="st">"hyperSpec"</span>)</code>.</p>
</div>
<div class="section level2">
<h2 id="plot-several-wavelength-ranges">
<span class="header-section-number">3.2</span> Plot Several Wavelength Ranges<a class="anchor" aria-label="anchor" href="#plot-several-wavelength-ranges"></a>
</h2>
<p>To plot severel wavelength ranges (Fig. <a href="#fig:wavelength-2">3.2</a>), use <code class="sourceCode r">wl.range =<span class="st"> </span><span class="kw">list</span> (<span class="dv">600</span> <span class="op">~</span><span class="st"> </span><span class="dv">1800</span>, <span class="dv">2800</span> <span class="op">~</span><span class="st"> </span><span class="dv">3100</span>)</code>.
Cut the wavelength axis appropriately with <code class="sourceCode r">xoffset =<span class="st"> </span><span class="dv">750</span></code>.
If available, the package package <strong>plotrix</strong><span class="citation">[<a href="#ref-R-plotrix" role="doc-biblioref">4</a>,<a href="#ref-plotrix2006" role="doc-biblioref">5</a>]</span> is used to produce the cut mark.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotspc.html">plotspc</a></span><span class="op">(</span><span class="va">paracetamol</span>,
  wl.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span> <span class="op">~</span> <span class="fl">1800</span>, <span class="fl">2800</span> <span class="op">~</span> <span class="va">max</span><span class="op">)</span>,
  xoffset <span class="op">=</span> <span class="fl">750</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:wavelength-2"></span>
<img src="plotting_files/figure-html/wavelength-2-1.png" alt="Plot of several wavelength (wavenumber) ranges.  "><p class="caption">
Figure 3.2: Plot of several wavelength (wavenumber) ranges.
</p>
</div>
</div>
<div class="section level2">
<h2 id="plot-with-reversed-abscissa">
<span class="header-section-number">3.3</span> Plot with Reversed Abscissa<a class="anchor" aria-label="anchor" href="#plot-with-reversed-abscissa"></a>
</h2>
<p>To create a plot with reversed abscissa (Fig. <a href="#fig:abscissa">3.3</a>), use <code class="sourceCode r">wl.reverse =<span class="st"> </span><span class="ot">TRUE</span></code></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotspc.html">plotspc</a></span><span class="op">(</span><span class="va">paracetamol</span>, wl.reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:abscissa"></span>
<img src="plotting_files/figure-html/abscissa-1.png" alt="Plot with reversed/descending wavelength (wavenumber) range.  "><p class="caption">
Figure 3.3: Plot with reversed/descending wavelength (wavenumber) range.
</p>
</div>
</div>
<div class="section level2">
<h2 id="plot-in-different-colours">
<span class="header-section-number">3.4</span> Plot in Different Colours<a class="anchor" aria-label="anchor" href="#plot-in-different-colours"></a>
</h2>
<p>To have different colours of spectra (Fig. <a href="#fig:colours">3.4</a>), use <code class="sourceCode r">col =<span class="st"> </span>vector_of_colours</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotspc.html">plotspc</a></span><span class="op">(</span><span class="va">flu</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/palettes.html">palette_matlab_dark</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:colours"></span>
<img src="plotting_files/figure-html/colours-1.png" alt="Spectra plotted in different colours.  "><p class="caption">
Figure 3.4: Spectra plotted in different colours.
</p>
</div>
</div>
<div class="section level2">
<h2 id="plot-dots-instead-of-lines">
<span class="header-section-number">3.5</span> Plot Dots Instead of Lines<a class="anchor" aria-label="anchor" href="#plot-dots-instead-of-lines"></a>
</h2>
<p>To plot dots instead of lines (Fig. <a href="#fig:dots">3.5</a>), use, e.g., <code class="sourceCode r">lines.args =<span class="st"> </span><span class="kw">list</span> (<span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">type =</span> <span class="st">"p"</span>)</code></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotspc.html">plotspc</a></span><span class="op">(</span><span class="va">paracetamol</span><span class="op">[</span>, , <span class="fl">2800</span> <span class="op">~</span> <span class="fl">3200</span><span class="op">]</span>,
  lines.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">20</span>, type <span class="op">=</span> <span class="st">"p"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:dots"></span>
<img src="plotting_files/figure-html/dots-1.png" alt="Spectrum with dots instead of lines.  "><p class="caption">
Figure 3.5: Spectrum with dots instead of lines.
</p>
</div>
</div>
<div class="section level2">
<h2 id="plot-mass-spectra">
<span class="header-section-number">3.6</span> Plot Mass Spectra<a class="anchor" aria-label="anchor" href="#plot-mass-spectra"></a>
</h2>
<p>TO plot mass spectra (Fig. <a href="#fig:mass">3.6</a>), use <code class="sourceCode r">lines.args =<span class="st"> </span><span class="kw">list</span>(<span class="dt">type =</span> <span class="st">"h"</span>)</code></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">barbiturates</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, lines.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"h"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:mass"></span>
<img src="plotting_files/figure-html/mass-1.png" alt="An example of mass spectrum.  "><p class="caption">
Figure 3.6: An example of mass spectrum.
</p>
</div>
</div>
<div class="section level2">
<h2 id="add-more-spectra-into-an-existing-plot">
<span class="header-section-number">3.7</span> Add More Spectra into an Existing Plot<a class="anchor" aria-label="anchor" href="#add-more-spectra-into-an-existing-plot"></a>
</h2>
<p>To plot additional spectra onto an existing plot (Fig. <a href="#fig:add">3.7</a>), use <code class="sourceCode r">add =<span class="st"> </span><span class="ot">TRUE</span></code></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotspc.html">plotspc</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span><span class="fl">30</span>, , <span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotspc.html">plotspc</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span><span class="fl">35</span>, , <span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:add"></span>
<img src="plotting_files/figure-html/add-1.png" alt="A spectrum added to an existing plot.  "><p class="caption">
Figure 3.7: A spectrum added to an existing plot.
</p>
</div>
</div>
<div class="section level2">
<h2 id="plot-summary-characteristics">
<span class="header-section-number">3.8</span> Plot Summary Characteristics<a class="anchor" aria-label="anchor" href="#plot-summary-characteristics"></a>
</h2>
<p>Argument <code class="sourceCode r">func</code> may be used to calculate summary characteristics before plotting.
To plot, e.g., the standard deviation of the spectra, use <code class="sourceCode r"><span class="kw">plotspc</span>(..., <span class="dt">func =</span> sd)</code> (Fig. <a href="#fig:sd">3.8</a>).</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotspc.html">plotspc</a></span><span class="op">(</span><span class="va">faux_cell_preproc</span>, func <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sd"></span>
<img src="plotting_files/figure-html/sd-1.png" alt="A spectrum of summary statistics calculated via `func` parameter.
In the example, the standard deviation is used.  "><p class="caption">
Figure 3.8: A spectrum of summary statistics calculated via <code>func</code> parameter.
In the example, the standard deviation is used.
</p>
</div>
</div>
<div class="section level2">
<h2 id="plot-different-line-at-i-0">
<span class="header-section-number">3.9</span> Plot Different Line at <span class="math inline">\(I = 0\)</span><a class="anchor" aria-label="anchor" href="#plot-different-line-at-i-0"></a>
</h2>
<p>To plot a different line at zero intensity <span class="math inline">\((I = 0)\)</span>, argument <code class="sourceCode r">zeroline</code> may be used (Fig. <a href="#fig:diffline">3.9</a>).
Argument <code class="sourceCode r">zeroline</code> takes a list with parameters that are passed to function <code class="sourceCode r"><span class="kw">abline</span>()</code>, <code class="sourceCode r"><span class="ot">NA</span></code> suppresses the line.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotspc.html">plotspc</a></span><span class="op">(</span><span class="va">paracetamol</span>,
  zeroline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:diffline"></span>
<img src="plotting_files/figure-html/diffline-1.png" alt="Spectrum with added zero-intensity line.  "><p class="caption">
Figure 3.9: Spectrum with added zero-intensity line.
</p>
</div>
</div>
<div class="section level2">
<h2 id="adding-annotations-to-a-spectra-plot">
<span class="header-section-number">3.10</span> Adding Annotations to a Spectra Plot<a class="anchor" aria-label="anchor" href="#adding-annotations-to-a-spectra-plot"></a>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotspc</span>()</code> uses base graphics.
After plotting the spectra, more content may be added to the graphic by <code class="sourceCode r"><span class="kw">abline</span>()</code>, <code class="sourceCode r"><span class="kw">lines</span>()</code>, <code class="sourceCode r"><span class="kw">points</span>()</code>, etc. (Fig. <a href="#fig:add-line">3.10</a>).</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">laser</span>, <span class="st">"spcmeansd"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>
  v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">405.0063</span>, <span class="fl">405.1121</span>, <span class="fl">405.2885</span>, <span class="fl">405.3591</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:add-line"></span>
<img src="plotting_files/figure-html/add-line-1.png" alt="A summary spectrum with annotation lines.  "><p class="caption">
Figure 3.10: A summary spectrum with annotation lines.
</p>
</div>
</div>
<div class="section level2">
<h2 id="sec:stacked-spectra">
<span class="header-section-number">3.11</span> Stacked Spectra<a class="anchor" aria-label="anchor" href="#sec:stacked-spectra"></a>
</h2>
<div class="section level3">
<h3 id="simple-stacking">
<span class="header-section-number">3.11.1</span> Simple Stacking<a class="anchor" aria-label="anchor" href="#simple-stacking"></a>
</h3>
<p>To stack spectra, use <code class="sourceCode r">stacked =<span class="st"> </span><span class="ot">TRUE</span></code> (Fig. <a href="#fig:stacked1">3.11</a>).</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotspc.html">plotspc</a></span><span class="op">(</span>
  <span class="va">cluster_means</span>,
  col <span class="op">=</span> <span class="va">cluster_cols</span>,
  stacked <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:stacked1"></span>
<img src="plotting_files/figure-html/stacked1-1.png" alt="Stacked spectra of means.  "><p class="caption">
Figure 3.11: Stacked spectra of means.
</p>
</div>
</div>
<div class="section level3">
<h3 id="stacking-groups-of-spectra">
<span class="header-section-number">3.11.2</span> Stacking Groups of Spectra<a class="anchor" aria-label="anchor" href="#stacking-groups-of-spectra"></a>
</h3>
<!-- ======================================================================= -->
<!-- ======================================================================= -->
<p>The spectra to be stacked can be grouped: <code class="sourceCode r">stacked =<span class="st"> "factor"</span></code>.
Alternatively, the name of an extra data column can be used for grouping (Fig. <a href="#fig:stacked2">3.12</a>).</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>las <span class="op">=</span> <span class="fl">1</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.1</span>, <span class="fl">.7</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span>
  <span class="va">cluster_meansd</span>,
  stacked <span class="op">=</span> <span class="st">".aggregate"</span>,
  fill    <span class="op">=</span> <span class="st">".aggregate"</span>,
  col     <span class="op">=</span> <span class="va">cluster_cols</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:stacked2"></span>
<img src="plotting_files/figure-html/stacked2-1.png" alt="Stacked summary spectra (mean $\pm$ one standard deviation).  "><p class="caption">
Figure 3.12: Stacked summary spectra (mean <span class="math inline">\(\pm\)</span> one standard deviation).
</p>
</div>
</div>
<div class="section level3">
<h3 id="manually-giving-yoffset">
<span class="header-section-number">3.11.3</span> Manually Giving <code>yoffset</code><a class="anchor" aria-label="anchor" href="#manually-giving-yoffset"></a>
</h3>
<p>Stacking values can also be given manually as numeric values in <code class="sourceCode r">yoffset</code> (Fig. <a href="#fig:stacked3">3.13</a>).</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotspc.html">plotspc</a></span><span class="op">(</span>
  <span class="va">cluster_meansd</span>,
  yoffset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">cluster_cols</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:stacked3"></span>
<img src="plotting_files/figure-html/stacked3-1.png" alt="Stacked spectra with customized y offset.  "><p class="caption">
Figure 3.13: Stacked spectra with customized y offset.
</p>
</div>
</div>
<div class="section level3">
<h3 id="dense-stacking">
<span class="header-section-number">3.11.4</span> Dense Stacking<a class="anchor" aria-label="anchor" href="#dense-stacking"></a>
</h3>
<p>It is possible to obtain a denser stacking (Fig. <a href="#fig:stacked4">3.14</a>).</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">yoffsets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply.html">apply</a></span><span class="op">(</span><span class="va">cluster_means</span><span class="op">[[</span><span class="op">]</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">diff</span><span class="op">)</span>
<span class="va">yoffsets</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="../reference/apply.html">apply</a></span><span class="op">(</span><span class="va">yoffsets</span>, <span class="fl">1</span>, <span class="va">min</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">cluster_means</span>,
  yoffset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">yoffsets</span><span class="op">)</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="va">cluster_cols</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:stacked4"></span>
<img src="plotting_files/figure-html/stacked4-1.png" alt="Dense-stacked spectra.  "><p class="caption">
Figure 3.14: Dense-stacked spectra.
</p>
</div>
</div>
<div class="section level3">
<h3 id="elaborate-example">
<span class="header-section-number">3.11.5</span> Elaborate Example<a class="anchor" aria-label="anchor" href="#elaborate-example"></a>
</h3>
<p>Function <code class="sourceCode r"><span class="kw">plotspc</span>()</code> allows fine grained customization of almost all aspects of the plot (see example in Fig. <a href="#fig:stacked5">3.15</a>).
This is possible by giving arguments to the functions that actually perform the plotting <code class="sourceCode r"><span class="kw">plot</span>()</code> for setting up the plot area, <code class="sourceCode r"><span class="kw">lines</span>()</code> for the plotting of the lines, <code class="sourceCode r"><span class="kw">axis</span>()</code> for the axes, etc.
The arguments for these functions should be given in lists as <code class="sourceCode r">plot.args</code>, <code class="sourceCode r">lines.args</code>, <code class="sourceCode r">axis.args</code>, etc.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">yoffset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply.html">apply</a></span><span class="op">(</span><span class="va">faux_cell_preproc</span>, <span class="fl">2</span>, <span class="va">quantile</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span>
<span class="va">yoffset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">yoffset</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">faux_cell_preproc</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
  plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">yoffset</span><span class="op">)</span>,
  lines.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">yoffset</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">yoffset</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">faux_cell_preproc</span>, <span class="st">"spcprctl5"</span>,
    yoffset <span class="op">=</span> <span class="va">yoffset</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
    col <span class="op">=</span> <span class="st">"gray"</span>, add <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>
  <span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">faux_cell_preproc</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
    yoffset <span class="op">=</span> <span class="va">yoffset</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
    col <span class="op">=</span> <span class="fu"><a href="../reference/palettes.html">palette_matlab_dark</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span>,
    lines.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:stacked5"></span>
<img src="plotting_files/figure-html/stacked5-1.png" alt="An example of highly customized spectra.  "><p class="caption">
Figure 3.15: An example of highly customized spectra.
</p>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="fun-plotc">
<span class="header-section-number">4</span> Calibration, (Depth) Profile, and Time Series Plots: <code class="sourceCode r"><span class="kw">plotc</span>()</code><a class="anchor" aria-label="anchor" href="#fun-plotc"></a>
</h1>
<!-- \mFun{`plotc()`{.r}} -->
<div class="section level2">
<h2 id="intensities-over-concentration">
<span class="header-section-number">4.1</span> Intensities over Concentration<a class="anchor" aria-label="anchor" href="#intensities-over-concentration"></a>
</h2>
<p>Spectra intensities of one wavelength can be plotted over the concentration for univariate calibration (Fig. <a href="#fig:lin-cal-1">4.1</a>).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotc.html">plotc</a></span><span class="op">(</span><span class="va">flu</span><span class="op">[</span>, , <span class="fl">450</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:lin-cal-1"></span>
<img src="plotting_files/figure-html/lin-cal-1-1.png" alt="Intensities at 450 nm over concentration.  "><p class="caption">
Figure 4.1: Intensities at 450 nm over concentration.
</p>
</div>
<p>The default is to use the first intensity only.</p>
</div>
<div class="section level2">
<h2 id="summary-intensities-over-concentration">
<span class="header-section-number">4.2</span> Summary Intensities over Concentration<a class="anchor" aria-label="anchor" href="#summary-intensities-over-concentration"></a>
</h2>
<p>A function to compute a summary of the intensities before the drawing can be used via argument <code>func</code> (Fig. <a href="#fig:lin-cal-3">4.2</a>).</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotc.html">plotc</a></span><span class="op">(</span><span class="va">flu</span>, func <span class="op">=</span> <span class="va">range</span>, groups <span class="op">=</span> <span class="va">.wavelength</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:lin-cal-3"></span>
<img src="plotting_files/figure-html/lin-cal-3-1.png" alt="The summary (minimum and maximum) of intensities at each measured concentration.  "><p class="caption">
Figure 4.2: The summary (minimum and maximum) of intensities at each measured concentration.
</p>
</div>
<p>If <code class="sourceCode r"><span class="kw">func</span>()</code> returns more than one value, the different results are accessible by <code>.wavelength</code>.</p>
</div>
<div class="section level2">
<h2 id="conditioning-plotting-more-traces-separately">
<span class="header-section-number">4.3</span> Conditioning: Plotting More Traces Separately<a class="anchor" aria-label="anchor" href="#conditioning-plotting-more-traces-separately"></a>
</h2>
<p><strong>Lattice</strong> conditioning (operator <code>|</code>) can be used to plot more traces separately (Fig. <a href="#fig:plotc2">4.3</a>).</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotc.html">plotc</a></span><span class="op">(</span><span class="va">flu</span><span class="op">[</span>, , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">405</span>, <span class="fl">445</span><span class="op">)</span><span class="op">]</span>, <span class="va">spc</span> <span class="op">~</span> <span class="va">c</span> <span class="op">|</span> <span class="va">.wavelength</span>,
  cex <span class="op">=</span> <span class="fl">.3</span>, scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alternating <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotc2"></span>
<img src="plotting_files/figure-html/plotc2-1.png" alt="Conditioning: several calibration spectra on separate subplots.  "><p class="caption">
Figure 4.3: Conditioning: several calibration spectra on separate subplots.
</p>
</div>
</div>
<div class="section level2">
<h2 id="grouping-plot-more-traces-in-one-panel">
<span class="header-section-number">4.4</span> Grouping: Plot More Traces in One Panel<a class="anchor" aria-label="anchor" href="#grouping-plot-more-traces-in-one-panel"></a>
</h2>
<p>Argument <code class="sourceCode r">groups</code> may be used as a grouping parameter to plot more traces in one panel (Fig. <a href="#fig:plotc3">4.4</a>).</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotc.html">plotc</a></span><span class="op">(</span><span class="va">flu</span><span class="op">[</span>, , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">405</span>, <span class="fl">445</span><span class="op">)</span><span class="op">]</span>, groups <span class="op">=</span> <span class="va">.wavelength</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotc3"></span>
<img src="plotting_files/figure-html/plotc3-1.png" alt="Grouping: several calibration spectra on one plot.  "><p class="caption">
Figure 4.4: Grouping: several calibration spectra on one plot.
</p>
</div>
</div>
<div class="section level2">
<h2 id="changing-axis-labels-and-other-parameters">
<span class="header-section-number">4.5</span> Changing Axis Labels (and Other Parameters)<a class="anchor" aria-label="anchor" href="#changing-axis-labels-and-other-parameters"></a>
</h2>
<p>Arguments of <strong>lattice</strong> function <code class="sourceCode r"><span class="kw">xyplot</span>()</code> can be given to <code class="sourceCode r"><span class="kw">plotc</span>()</code> (Fig. <a href="#fig:lin-cal-4">4.5</a>).</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotc.html">plotc</a></span><span class="op">(</span><span class="va">flu</span><span class="op">[</span>, , <span class="fl">450</span><span class="op">]</span>,
  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">I</span><span class="op">[</span><span class="st">"450 nm"</span><span class="op">]</span> <span class="op">/</span> <span class="va">a.u.</span><span class="op">)</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">flu</span><span class="op">$</span><span class="va">c</span> <span class="op">+</span> <span class="fl">.01</span><span class="op">)</span>,
  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">flu</span><span class="op">$</span><span class="va">spc</span> <span class="op">+</span> <span class="fl">10</span><span class="op">)</span>,
  pch <span class="op">=</span> <span class="fl">4</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:lin-cal-4"></span>
<img src="plotting_files/figure-html/lin-cal-4-1.png" alt="Modified axis labels and point characters.  "><p class="caption">
Figure 4.5: Modified axis labels and point characters.
</p>
</div>
</div>
<div class="section level2">
<h2 id="adding-things-to-the-plot-customized-panel-function">
<span class="header-section-number">4.6</span> Adding Things to the Plot: Customized Panel Function<a class="anchor" aria-label="anchor" href="#adding-things-to-the-plot-customized-panel-function"></a>
</h2>
<p>As <code class="sourceCode r"><span class="kw">plotc</span>()</code> uses the package <strong>lattice</strong> function <code class="sourceCode r"><span class="kw">xyplot</span>()</code>, additions to the plot must be made via the panel function (Fig. <a href="#fig:lin-cal-5">4.6</a>).</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">panelcalibration</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span>, <span class="va">clim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">level</span> <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.xyplot.html" class="external-link">panel.xyplot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span>
  <span class="va">lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.functions.html" class="external-link">panel.abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">lm</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>
  <span class="va">cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seq.html">seq</a></span><span class="op">(</span><span class="va">clim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">clim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
  <span class="va">cy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lm</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cx</span><span class="op">)</span>,
    interval <span class="op">=</span> <span class="st">"confidence"</span>,
    level <span class="op">=</span> <span class="va">level</span>
  <span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/llines.html" class="external-link">panel.lines</a></span><span class="op">(</span><span class="va">cx</span>, <span class="va">cy</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/llines.html" class="external-link">panel.lines</a></span><span class="op">(</span><span class="va">cx</span>, <span class="va">cy</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotc.html">plotc</a></span><span class="op">(</span><span class="va">flu</span><span class="op">[</span>, , <span class="fl">405</span><span class="op">]</span>,
  panel <span class="op">=</span> <span class="va">panelcalibration</span>,
  pch <span class="op">=</span> <span class="fl">4</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.35</span><span class="op">)</span>, level <span class="op">=</span> <span class="fl">.99</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:lin-cal-5"></span>
<img src="plotting_files/figure-html/lin-cal-5-1.png" alt="Plot that uses a customized paanel function.  "><p class="caption">
Figure 4.6: Plot that uses a customized paanel function.
</p>
</div>
</div>
<div class="section level2">
<h2 id="sec:time-series">
<span class="header-section-number">4.7</span> Time Series and Other Plots of the Type “Intensity-over-Something”<a class="anchor" aria-label="anchor" href="#sec:time-series"></a>
</h2>
<p>Abscissae other than <code>c</code> may be specified by explicitly giving the model formula (Fig. <a href="#fig:plotc4">4.7</a>).</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotc.html">plotc</a></span><span class="op">(</span><span class="va">laser</span><span class="op">[</span>, , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">405.0063</span>, <span class="fl">405.1121</span>, <span class="fl">405.2885</span>, <span class="fl">405.3591</span><span class="op">)</span><span class="op">]</span>,
  <span class="va">spc</span> <span class="op">~</span> <span class="va">t</span>,
  groups <span class="op">=</span> <span class="va">.wavelength</span>,
  type   <span class="op">=</span> <span class="st">"b"</span>,
  col    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotc4"></span>
<img src="plotting_files/figure-html/plotc4-1.png" alt="Plot with abscissae explicitly indicated by model formula.  "><p class="caption">
Figure 4.7: Plot with abscissae explicitly indicated by model formula.
</p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="fun-levelplot">
<span class="header-section-number">5</span> Levelplot: <code class="sourceCode r"><span class="kw">levelplot</span>()</code><a class="anchor" aria-label="anchor" href="#fun-levelplot"></a>
</h1>
<p>Package <strong>hyperSpec</strong>’s function <code class="sourceCode r"><span class="kw">levelplot</span>()</code> can use two special column names:</p>
<ul>
<li>
<strong>.wavelength</strong> for the wavelengths,</li>
<li>
<strong>.row</strong> for the row index (i.e., spectrum number) in the data.</li>
</ul>
<p>Besides that, it behaves exactly like <strong>lattice</strong> <code class="sourceCode r"><span class="kw">levelplot</span>()</code>.
Particularly, the data is given as the <em>second</em> argument (Fig. <a href="#fig:levelplot">5.1</a>).</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/levelplot.html" class="external-link">levelplot</a></span><span class="op">(</span><span class="va">spc</span> <span class="op">~</span> <span class="va">x</span> <span class="op">*</span> <span class="va">y</span>, data <span class="op">=</span> <span class="va">faux_cell</span><span class="op">[</span>, , <span class="fl">800</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:levelplot"></span>
<img src="plotting_files/figure-html/levelplot-1.png" alt="An example of a levelplot.  "><p class="caption">
Figure 5.1: An example of a levelplot.
</p>
</div>
<p>If the colour-coded value is a factor, the display is adjusted to this fact (Fig. <a href="#fig:levelplot-factor">5.2</a>).</p>
<!-- Factors as `z` -->
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/levelplot.html" class="external-link">levelplot</a></span><span class="op">(</span><span class="va">region</span> <span class="op">~</span> <span class="va">x</span> <span class="op">*</span> <span class="va">y</span>, data <span class="op">=</span> <span class="va">faux_cell</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:levelplot-factor"></span>
<img src="plotting_files/figure-html/levelplot-factor-1.png" alt="Levelplot when colour-coded value is a factor.  "><p class="caption">
Figure 5.2: Levelplot when colour-coded value is a factor.
</p>
</div>
</div>
<div class="section level1">
<h1 id="fun-plotmat">
<span class="header-section-number">6</span> Spectra Matrix: <code class="sourceCode r"><span class="kw">plotmat</span>()</code><a class="anchor" aria-label="anchor" href="#fun-plotmat"></a>
</h1>
<p>It is often useful to plot the spectra against an additional coordinate, e.g., the time for time
series, the depth for depth profiles, etc.
This can be done by <code class="sourceCode r"><span class="kw">plot</span>(object, <span class="st">"mat"</span>)</code>.
The actual plotting is done by <code class="sourceCode r"><span class="kw">image</span>()</code>, but <code class="sourceCode r"><span class="kw">levelplot</span>()</code> can produce spectra matrix plots as well and these plots can be grouped or conditioned.</p>
<div class="section level2">
<h2 id="different-palette">
<span class="header-section-number">6.1</span> Different Palette<a class="anchor" aria-label="anchor" href="#different-palette"></a>
</h2>
<p>Argument <code>col</code> can be used to provide a different colour palette (Fig. <a href="#fig:plotmat1">6.1</a>).</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">laser</span>, <span class="st">"mat"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">heat.colors</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmat1"></span>
<img src="plotting_files/figure-html/plotmat1-1.png" alt="Spectra matrix with non-default palette.  "><p class="caption">
Figure 6.1: Spectra matrix with non-default palette.
</p>
</div>
<p>This is the same as:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotmat.html">plotmat</a></span><span class="op">(</span><span class="va">laser</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">heat.colors</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="different-y-axis">
<span class="header-section-number">6.2</span> Different Y-Axis<a class="anchor" aria-label="anchor" href="#different-y-axis"></a>
</h2>
<p>Different extra data column can be used as y-axis (Fig. <a href="#fig:plotmat2">6.2</a>).</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotmat.html">plotmat</a></span><span class="op">(</span><span class="va">laser</span>, y <span class="op">=</span> <span class="st">"t"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmat2"></span>
<img src="plotting_files/figure-html/plotmat2-1.png" alt="Spectra matrix with time (in column `t`) on y axis.    "><p class="caption">
Figure 6.2: Spectra matrix with time (in column <code>t</code>) on y axis.
</p>
</div>
<p>Alternatively, y values and axis label can be given separately.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotmat.html">plotmat</a></span><span class="op">(</span><span class="va">laser</span>, y <span class="op">=</span> <span class="va">laser</span><span class="op">$</span><span class="va">t</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/labels.html" class="external-link">labels</a></span><span class="op">(</span><span class="va">laser</span>, <span class="st">"t"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contour-lines">
<span class="header-section-number">6.3</span> Contour Lines<a class="anchor" aria-label="anchor" href="#contour-lines"></a>
</h2>
<p>Contour lines may also be added (Fig. <a href="#fig:plotmat3">6.3</a>).</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotmat.html">plotmat</a></span><span class="op">(</span><span class="va">flu</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/palettes.html">palette_matlab_dark</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotmat.html">plotmat</a></span><span class="op">(</span><span class="va">flu</span>, col <span class="op">=</span> <span class="st">"white"</span>, contour <span class="op">=</span> <span class="cn">TRUE</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmat3"></span>
<img src="plotting_files/figure-html/plotmat3-1.png" alt="Spectra matrix with added contour lines.  "><p class="caption">
Figure 6.3: Spectra matrix with added contour lines.
</p>
</div>
</div>
<div class="section level2">
<h2 id="colour-coded-points-special-panel-function">
<span class="header-section-number">6.4</span> Colour-Coded Points: Special Panel Function<a class="anchor" aria-label="anchor" href="#colour-coded-points-special-panel-function"></a>
</h2>
<p>In <code class="sourceCode r"><span class="kw">levelplot</span>()</code>, colour-coded points may be set via special panel function (Fig. <a href="#fig:plotmap-barb">6.4</a>).</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://latticeextra.r-forge.r-project.org/" class="external-link">"latticeExtra"</a></span><span class="op">)</span>

<span class="va">barb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/collapse.html">collapse</a></span><span class="op">(</span><span class="va">barbiturates</span><span class="op">)</span>
<span class="va">barb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wl_sort.html">wl_sort</a></span><span class="op">(</span><span class="va">barb</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/levelplot.html" class="external-link">levelplot</a></span><span class="op">(</span><span class="va">spc</span> <span class="op">~</span> <span class="va">.wavelength</span> <span class="op">*</span> <span class="va">z</span>, <span class="va">barb</span>,
  panel <span class="op">=</span> <span class="va">panel.levelplot.points</span>,
  cex <span class="op">=</span> <span class="fl">.33</span>, col.symbol <span class="op">=</span> <span class="cn">NA</span>,
  col.regions <span class="op">=</span> <span class="va">palette_matlab</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmap-barb"></span>
<img src="plotting_files/figure-html/plotmap-barb-1.png" alt="Colour-coded points via special panel function.  "><p class="caption">
Figure 6.4: Colour-coded points via special panel function.
</p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="fun-plotmap">
<span class="header-section-number">7</span> False-Colour Maps: <code class="sourceCode r"><span class="kw">plotmap</span>()</code><a class="anchor" aria-label="anchor" href="#fun-plotmap"></a>
</h1>
<div class="section level2">
<h2 id="plotmap">
<span class="header-section-number">7.1</span> Plotting map<a class="anchor" aria-label="anchor" href="#plotmap"></a>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotmap</span>()</code> is a specialized version of <code class="sourceCode r"><span class="kw">levelplot</span>()</code> (Fig. <a href="#fig:plotmap-clu">7.3</a>).
The spectral intensities may be summarized by a function before plotting (default: <code class="sourceCode r"><span class="kw">mean</span>()</code>).
The same scale is used for x and y axes (<code class="sourceCode r">aspect =<span class="st"> "iso"</span></code>).</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">plotmap</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span>, , <span class="fl">1200</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmap-faux-cell"></span>
<img src="plotting_files/figure-html/plotmap-faux-cell-1.png" alt="An example of a false colour map.  "><p class="caption">
Figure 7.1: An example of a false colour map.
</p>
</div>
</div>
<div class="section level2">
<h2 id="plotmap-manual-xy">
<span class="header-section-number">7.2</span> Plotting Maps with Manually Specified X and Y Axes<a class="anchor" aria-label="anchor" href="#plotmap-manual-xy"></a>
</h2>
<p>Specify the colour-coded variable, abscissa and ordinate as formula: <code class="sourceCode r">colour.coded <span class="op">~</span><span class="st"> </span>abscissa <span class="op">*</span><span class="st"> </span>ordinate</code> (Fig. <a href="#fig:plotmap-yx">7.2</a>).</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">plotmap</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span>, , <span class="fl">1200</span><span class="op">]</span>, <span class="va">spc</span> <span class="op">~</span> <span class="va">y</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmap-yx"></span>
<img src="plotting_files/figure-html/plotmap-yx-1.png" alt="False colour map with an explicit specification of x and y axes.  "><p class="caption">
Figure 7.2: False colour map with an explicit specification of x and y axes.
</p>
</div>
</div>
<div class="section level2">
<h2 id="discrete-colours">
<span class="header-section-number">7.3</span> Discrete Colours<a class="anchor" aria-label="anchor" href="#discrete-colours"></a>
</h2>
<p>Factor variables may be used for discrete colour coding (Fig. <a href="#fig:plotmap-clu">7.3</a>).</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">plotmap</a></span><span class="op">(</span><span class="va">faux_cell</span>, <span class="va">region</span> <span class="op">~</span> <span class="va">x</span> <span class="op">*</span> <span class="va">y</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmap-clu"></span>
<img src="plotting_files/figure-html/plotmap-clu-1.png" alt="False colour map with colours defined by a factor variable.  "><p class="caption">
Figure 7.3: False colour map with colours defined by a factor variable.
</p>
</div>
<p>If the colour-coded variable is a factor, each level gets its own colour, and the legend is labelled accordingly.</p>
</div>
<div class="section level2">
<h2 id="different-palette-1">
<span class="header-section-number">7.4</span> Different Palette<a class="anchor" aria-label="anchor" href="#different-palette-1"></a>
</h2>
<p>To use a different palette, use argument <code class="sourceCode r">col.regions</code> (Fig. <a href="#fig:plotmap-col">7.4</a>).</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">plotmap</a></span><span class="op">(</span><span class="va">faux_cell</span>, <span class="va">region</span> <span class="op">~</span> <span class="va">x</span> <span class="op">*</span> <span class="va">y</span>, col.regions <span class="op">=</span> <span class="va">cluster_cols</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmap-col"></span>
<img src="plotting_files/figure-html/plotmap-col-1.png" alt="False colour map with non-default colour palette.  "><p class="caption">
Figure 7.4: False colour map with non-default colour palette.
</p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="fine-tuning-lattice-parameters">
<span class="header-section-number">8</span> Fine-Tuning <strong><em>lattice</em></strong> Parameters<a class="anchor" aria-label="anchor" href="#fine-tuning-lattice-parameters"></a>
</h1>
<p>The plotting of colour maps is done via R package <strong>lattice</strong> (aka Trellis graphic approach), which is highly customizable.
Use function <code class="sourceCode r"><span class="kw">trellis.par.get</span>()</code> and <code class="sourceCode r"><span class="kw">trellis.par.set</span>()</code> to get/set the settings for the current graphics device.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_theme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html" class="external-link">trellis.par.get</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">my_theme</span><span class="op">)</span> <span class="co"># note how many parameters are tunable</span>
<span class="co">#&gt;  [1] "grid.pars"         "fontsize"          "background"        "panel.background" </span>
<span class="co">#&gt;  [5] "clip"              "add.line"          "add.text"          "plot.polygon"     </span>
<span class="co">#&gt;  [9] "box.dot"           "box.rectangle"     "box.umbrella"      "dot.line"         </span>
<span class="co">#&gt; [13] "dot.symbol"        "plot.line"         "plot.symbol"       "reference.line"   </span>
<span class="co">#&gt; [17] "strip.background"  "strip.shingle"     "strip.border"      "superpose.line"   </span>
<span class="co">#&gt; [21] "superpose.symbol"  "superpose.polygon" "regions"           "shade.colors"     </span>
<span class="co">#&gt; [25] "axis.line"         "axis.text"         "axis.components"   "layout.heights"   </span>
<span class="co">#&gt; [29] "layout.widths"     "box.3d"            "par.title.text"    "par.xlab.text"    </span>
<span class="co">#&gt; [33] "par.ylab.text"     "par.zlab.text"     "par.main.text"     "par.sub.text"</span></code></pre></div>
<p>Any of these parameters can be fine-tuned to produce the desired output.
For example, parameter <code class="sourceCode r">my_theme<span class="op">$</span>region</code> is responsible for the appearance of color maps, and it contains elements <code class="sourceCode r"><span class="op">$</span>alpha</code> and <code class="sourceCode r"><span class="op">$</span>col</code>.
By changing these parameters you can create your own theme for plotting and pass it to the plotting function via <code class="sourceCode r">par.settings</code>.</p>
<div class="section level2">
<h2 id="changed-palette">
<span class="header-section-number">8.1</span> Changed Palette<a class="anchor" aria-label="anchor" href="#changed-palette"></a>
</h2>
<p>Fig. <a href="#fig:plotmap-col-default">8.1</a> uses a customized <strong>lattice</strong> theme.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_theme</span><span class="op">$</span><span class="va">regions</span><span class="op">$</span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">terrain.colors</a></span>
<span class="fu"><a href="../reference/levelplot.html">plotmap</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span>, , <span class="fl">1200</span><span class="op">]</span>, par.settings <span class="op">=</span> <span class="va">my_theme</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmap-col-default"></span>
<img src="plotting_files/figure-html/plotmap-col-default-1.png" alt="A false-colour map that uses `terrain.colors` palette.   "><p class="caption">
Figure 8.1: A false-colour map that uses <code>terrain.colors</code> palette.
</p>
</div>
<p>It is possible to <strong>persistently</strong> (i.e. inside of the current R session) set <strong>lattice</strong> parameters, so they would apply to all further plots.
This is done via a call to <code class="sourceCode r"><span class="kw">trellis.par.set</span>()</code>, for example <code class="sourceCode r"><span class="kw">trellis.par.set</span>(my_theme)</code>.</p>
<p>The current settings can be visualized via a call to <code class="sourceCode r"><span class="kw">show.settings</span>()</code></p>
</div>
<div class="section level2">
<h2 id="show-current-lattice-settings">
<span class="header-section-number">8.2</span> Show Current <strong><em>lattice</em></strong> Settings<a class="anchor" aria-label="anchor" href="#show-current-lattice-settings"></a>
</h2>
<p>Graphical parameters for <em>trellis</em> may be displayed via <code class="sourceCode r"><span class="kw">show.settings</span>()</code> (Fig. <a href="#fig:lattice-settings">8.2</a>).</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Display current trellis parameters</span>
<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html" class="external-link">show.settings</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html" class="external-link">show.settings</a></span><span class="op">(</span><span class="va">my_theme</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:lattice-settings"></span>
<img src="plotting_files/figure-html/lattice-settings-1.png" alt="Show **lattice** settings.  "><p class="caption">
Figure 8.2: Show <strong>lattice</strong> settings.
</p>
</div>
<p>An overview of different colour palettes, and ways to create your own, can be found
in the <a href="https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/colorPaletteCheatsheet.pdf" class="external-link">R colour cheatsheet</a>.</p>
</div>
<div class="section level2">
<h2 id="defined-wavelengths">
<span class="header-section-number">8.3</span> Defined Wavelengths<a class="anchor" aria-label="anchor" href="#defined-wavelengths"></a>
</h2>
<p>A map of the average intensity at particular wavelengths can be plotted if the wavelengths of interested are explicitly extracted (Fig. <a href="#fig:plotmap-wave">8.3</a>).</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">plotmap</a></span><span class="op">(</span>
  <span class="va">faux_cell_preproc</span><span class="op">[</span>, , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">800</span>, <span class="fl">1500</span><span class="op">)</span><span class="op">]</span>,
  col.regions <span class="op">=</span> <span class="va">palette_matlab</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmap-wave"></span>
<img src="plotting_files/figure-html/plotmap-wave-1.png" alt="A map of average intensity at explicitly indicated wavelengths.  "><p class="caption">
Figure 8.3: A map of average intensity at explicitly indicated wavelengths.
</p>
</div>
</div>
<div class="section level2">
<h2 id="conditioning">
<span class="header-section-number">8.4</span> Conditioning<a class="anchor" aria-label="anchor" href="#conditioning"></a>
</h2>
<p>Logical conditions may be used to create subplots (Fig. <a href="#fig:plotmap-pca">8.4</a>).</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">plotmap</a></span><span class="op">(</span>
  <span class="va">faux_cell</span><span class="op">[</span>, , <span class="fl">1500</span><span class="op">]</span>,
  <span class="va">spc</span> <span class="op">~</span> <span class="va">y</span> <span class="op">*</span> <span class="va">x</span> <span class="op">|</span> <span class="va">x</span> <span class="op">&gt;</span> <span class="fl">5</span>,
  col.regions <span class="op">=</span> <span class="fu"><a href="../reference/palettes.html">palette_matlab</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmap-pca"></span>
<img src="plotting_files/figure-html/plotmap-pca-1.png" alt="Subplots created by logical conditions.  "><p class="caption">
Figure 8.4: Subplots created by logical conditions.
</p>
</div>
</div>
<div class="section level2">
<h2 id="conditioning-on--wavelength">
<span class="header-section-number">8.5</span> Conditioning on <code class="sourceCode r">.wavelength</code><a class="anchor" aria-label="anchor" href="#conditioning-on--wavelength"></a>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">plotmap</span>()</code> automatically applies the function in <code class="sourceCode r">func</code> before plotting.
Argument <code class="sourceCode r">func</code> defaults to function <code class="sourceCode r"><span class="kw">mean</span>()</code>.
In order to suppress this, use <code class="sourceCode r">func =<span class="st"> </span><span class="ot">NULL</span></code>.
This allows conditioning on the wavelengths.</p>
<p>Fig. <a href="#fig:plotmap-pca2">8.5</a> demonstrates an example to plot the maps of principal components scores.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="op">~</span><span class="va">spc</span>, data <span class="op">=</span> <span class="va">faux_cell_preproc</span><span class="op">$</span><span class="va">.</span><span class="op">)</span>

<span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decomposition.html">decomposition</a></span><span class="op">(</span><span class="va">faux_cell</span>, <span class="va">pca</span><span class="op">$</span><span class="va">x</span>,
  label.wavelength <span class="op">=</span> <span class="st">"PC"</span>,
  label.spc <span class="op">=</span> <span class="st">"score /  a.u."</span>
<span class="op">)</span>

<span class="fu"><a href="../reference/levelplot.html">plotmap</a></span><span class="op">(</span>
  <span class="va">scores</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,
  <span class="va">spc</span> <span class="op">~</span> <span class="va">y</span> <span class="op">*</span> <span class="va">x</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">.wavelength</span><span class="op">)</span>,
  func <span class="op">=</span> <span class="cn">NULL</span>,
  col.regions <span class="op">=</span> <span class="fu"><a href="../reference/palettes.html">palette_matlab</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmap-pca2"></span>
<img src="plotting_files/figure-html/plotmap-pca2-1.png" alt="The maps of the scores of the first two principal components (I).  "><p class="caption">
Figure 8.5: The maps of the scores of the first two principal components (I).
</p>
</div>
<p>Alternatively, use <code class="sourceCode r"><span class="kw">levelplot</span>()</code> directly (Fig. <a href="#fig:plotmap-pca3">8.6</a>).</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/levelplot.html" class="external-link">levelplot</a></span><span class="op">(</span>
  <span class="va">spc</span> <span class="op">~</span> <span class="va">y</span> <span class="op">*</span> <span class="va">x</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">.wavelength</span><span class="op">)</span>,
  <span class="va">scores</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,
  aspect <span class="op">=</span> <span class="st">"iso"</span>,
  col.regions <span class="op">=</span> <span class="fu"><a href="../reference/palettes.html">palette_matlab</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotmap-pca3"></span>
<img src="plotting_files/figure-html/plotmap-pca3-1.png" alt="The maps of the scores of the first two principal components (II).  "><p class="caption">
Figure 8.6: The maps of the scores of the first two principal components (II).
</p>
</div>
</div>
<div class="section level2">
<h2 id="voronoi-plot">
<span class="header-section-number">8.6</span> Voronoi Plot<a class="anchor" aria-label="anchor" href="#voronoi-plot"></a>
</h2>
<p>Fig. <a href="#fig:voronoi-2">8.7</a> shows an example of a Voronoi plot.
Voronoi uses <code class="sourceCode r"><span class="kw">panel.voronoi</span>()</code> from package <strong>latticeExtra</strong><span class="citation">[<a href="#ref-R-latticeExtra" role="doc-biblioref">6</a>]</span>.
The tesselation is calculated by default using package <strong>deldir</strong><span class="citation">[<a href="#ref-R-deldir" role="doc-biblioref">7</a>]</span>, but package <strong>tripack</strong><span class="citation">[<a href="#ref-R-tripack" role="doc-biblioref">1</a>]</span> can also be used.
Package <strong>tripack</strong> seems to be faster in general, but may “hang” with certain data sets (particularly regular grids with missing spectra as in this example).
Furthermore, it is not FOSS (free and open-source software), so users are kindly asked to review package <strong>tripack</strong>’s license before using it.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">plotvoronoi</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/sample.html">sample</a></span><span class="op">(</span><span class="va">faux_cell</span>, <span class="fl">300</span><span class="op">)</span>, <span class="va">region</span> <span class="op">~</span> <span class="va">x</span> <span class="op">*</span> <span class="va">y</span>,
  col.regions <span class="op">=</span> <span class="fu"><a href="../reference/palettes.html">palette_matlab</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:voronoi-2"></span>
<img src="plotting_files/figure-html/voronoi-2-1.png" alt="Voronoi plot that uses non-default discrette colour palette.  "><p class="caption">
Figure 8.7: Voronoi plot that uses non-default discrette colour palette.
</p>
</div>
</div>
<div class="section level2">
<h2 id="mark-missing-spectra">
<span class="header-section-number">8.7</span> Mark Missing Spectra<a class="anchor" aria-label="anchor" href="#mark-missing-spectra"></a>
</h2>
<p>If the spectra come from a rectangular grid, missing positions can be marked with the following panel function:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mark.missing</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.levelplot.html" class="external-link">panel.levelplot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span>, <span class="va">...</span><span class="op">)</span>

  <span class="va">miss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>
  <span class="va">miss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge.html">merge</a></span><span class="op">(</span><span class="va">miss</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="cn">TRUE</span><span class="op">)</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">miss</span> <span class="op">&lt;-</span> <span class="va">miss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">miss</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.xyplot.html" class="external-link">panel.xyplot</a></span><span class="op">(</span><span class="va">miss</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">miss</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">4</span>, <span class="va">...</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Fig. <a href="#fig:missing">8.8</a> shows the result.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">plotmap</a></span><span class="op">(</span><span class="fu"><a href="../reference/sample.html">sample</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span>, , <span class="fl">1200</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">)</span> <span class="op">-</span> <span class="fl">20</span><span class="op">)</span>,
  col.regions <span class="op">=</span> <span class="fu"><a href="../reference/palettes.html">palette_matlab</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="st">"black"</span>,
  panel <span class="op">=</span> <span class="va">mark.missing</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:missing"></span>
<img src="plotting_files/figure-html/missing-1.png" alt="Marks of missing spectra in a false-colour map.  "><p class="caption">
Figure 8.8: Marks of missing spectra in a false-colour map.
</p>
</div>
</div>
<div class="section level2">
<h2 id="unevenly-spaced-measurement-grid">
<span class="header-section-number">8.8</span> Unevenly Spaced Measurement Grid<a class="anchor" aria-label="anchor" href="#unevenly-spaced-measurement-grid"></a>
</h2>
<p>The panel function used by <code class="sourceCode r"><span class="kw">plotmap</span>()</code> defaults to <code class="sourceCode r"><span class="kw">panel.levelplot.raster</span>()</code> which assumes an evenly spaced measurement grid.
Even if the spectra are measured on a nominally evenly spaced grid, the actual stage position may slightly vary due to positioning inaccuracy and some manufacturers (e.g., Kaiser) record the position reported by the stage rather than the position requested by the stage control.
This leads to weird-looking output with holes, and possibly wrong columns (Fig. <a href="#fig:uneven-I">8.9</a>).</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">uneven</span> <span class="op">&lt;-</span> <span class="va">faux_cell</span><span class="op">[</span>, , <span class="fl">1200</span><span class="op">]</span>
<span class="va">uneven</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">uneven</span><span class="op">$</span><span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">uneven</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">uneven</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">uneven</span><span class="op">$</span><span class="va">y</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">uneven</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">plotmap</a></span><span class="op">(</span><span class="va">uneven</span><span class="op">)</span>
<span class="co">#&gt; Warning in (function (x, y, z, subscripts, at = pretty(z), ..., col.regions = regions$col, : 'x'</span>
<span class="co">#&gt; values are not equispaced; output may be wrong</span>
<span class="co">#&gt; Warning in (function (x, y, z, subscripts, at = pretty(z), ..., col.regions = regions$col, : 'y'</span>
<span class="co">#&gt; values are not equispaced; output may be wrong</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:uneven-I"></span>
<img src="plotting_files/figure-html/uneven-I-1.png" alt="Unevenly spaced measurement grid: example I.
Note warnings `values are not equispaced; output may be wrong`."><p class="caption">
Figure 8.9: Unevenly spaced measurement grid: example I.
Note warnings <code>values are not equispaced; output may be wrong</code>.
</p>
</div>
<p>The symptom of this situation are warnings about values in x and/or y not being equispaced; and that the output, therefore, may be wrong.</p>
<p>One possibility to obtain a correct map is using <code class="sourceCode r"><span class="kw">plotvoronoi</span>()</code> instead which will construct a mosaic-like image with the respective “pixel” areas being centred around the actually recorded <code>$x</code> and <code>$y</code> position (Fig. <a href="#fig:uneven-II">8.10</a>).</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">plotvoronoi</a></span><span class="op">(</span><span class="va">uneven</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:uneven-II"></span>
<img src="plotting_files/figure-html/uneven-II-1.png" alt="Unevenly spaced measurement grid: example II.  "><p class="caption">
Figure 8.10: Unevenly spaced measurement grid: example II.
</p>
</div>
<p>Another possibility that underlines a point shape of the measurements is switching to <code class="sourceCode r">latticeExtra<span class="op">::</span><span class="kw">panel.levelplot.points</span>()</code> (Fig. <a href="#fig:uneven-III">8.11</a>).</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">plotmap</a></span><span class="op">(</span>
  <span class="va">uneven</span>,
  panel <span class="op">=</span> <span class="va">panel.levelplot.points</span>,
  cex <span class="op">=</span> <span class="fl">0.75</span>,
  col.symbol <span class="op">=</span> <span class="cn">NA</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:uneven-III"></span>
<img src="plotting_files/figure-html/uneven-III-1.png" alt="Unevenly spaced measurement grid: example III.  "><p class="caption">
Figure 8.11: Unevenly spaced measurement grid: example III.
</p>
</div>
<p>Alternatively, the measurement raster positions can be rounded to their nominal raster (e.g. Fig. <a href="#fig:uneven-IV">8.12</a>).</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeraster.html">makeraster</a></span><span class="op">(</span><span class="va">uneven</span><span class="op">$</span><span class="va">x</span>, startx <span class="op">=</span> <span class="op">-</span><span class="fl">11.55</span>, d <span class="op">=</span> <span class="fl">1</span>, tol <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>
<span class="va">uneven</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">rx</span><span class="op">$</span><span class="va">x</span>

<span class="va">ry</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeraster.html">makeraster</a></span><span class="op">(</span><span class="va">uneven</span><span class="op">$</span><span class="va">y</span>, startx <span class="op">=</span> <span class="op">-</span><span class="fl">4.77</span>, d <span class="op">=</span> <span class="fl">1</span>, tol <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>
<span class="va">uneven</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">ry</span><span class="op">$</span><span class="va">x</span>

<span class="fu"><a href="../reference/levelplot.html">plotmap</a></span><span class="op">(</span><span class="va">uneven</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:uneven-IV"></span>
<img src="plotting_files/figure-html/uneven-IV-1.png" alt="Unevenly spaced measurement grid: example IV.  "><p class="caption">
Figure 8.12: Unevenly spaced measurement grid: example IV.
</p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="plots-3d">
<span class="header-section-number">9</span> 3D Plots (with package <strong><em>rgl</em></strong>)<a class="anchor" aria-label="anchor" href="#plots-3d"></a>
</h1>
<p>Package <strong>rgl</strong><span class="citation">[<a href="#ref-R-rgl" role="doc-biblioref">8</a>]</span> offers fast 3d plotting in R.
As package <strong>rgl</strong>’s axis annotations are sometimes awkward, they may better be set manually:</p>
<!-- evaluation in rgl-do -->
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmurdoch/rgl" class="external-link">rgl</a></span><span class="op">)</span>

<span class="va">laser</span> <span class="op">&lt;-</span> <span class="va">laser</span><span class="op">[</span>, , <span class="fl">404.8</span> <span class="op">~</span> <span class="fl">405.6</span><span class="op">]</span> <span class="op">/</span> <span class="fl">10000</span>
<span class="va">laser</span><span class="op">$</span><span class="va">t</span> <span class="op">&lt;-</span> <span class="va">laser</span><span class="op">$</span><span class="va">t</span> <span class="op">/</span> <span class="fl">3600</span>
<span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="../reference/palettes.html">palette_matlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">laser</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/dim.html">nwl</a></span><span class="op">(</span><span class="va">laser</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/surface3d.html" class="external-link">surface3d</a></span><span class="op">(</span>
  y <span class="op">=</span> <span class="fu"><a href="../reference/wl.html">wl</a></span><span class="op">(</span><span class="va">laser</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">laser</span><span class="op">$</span><span class="va">t</span>,
  z <span class="op">=</span> <span class="va">laser</span><span class="op">$</span><span class="va">spc</span>, col <span class="op">=</span> <span class="va">cols</span>
<span class="op">)</span>
<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/aspect3d.html" class="external-link">aspect3d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/axes3d.html" class="external-link">axes3d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x+-"</span>, <span class="st">"y--"</span>, <span class="st">"z--"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/axes3d.html" class="external-link">axes3d</a></span><span class="op">(</span><span class="st">"y--"</span>, nticks <span class="op">=</span> <span class="fl">25</span>, labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/axes3d.html" class="external-link">mtext3d</a></span><span class="op">(</span><span class="st">"t / h"</span>, <span class="st">"x+-"</span>, line <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>
<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/axes3d.html" class="external-link">mtext3d</a></span><span class="op">(</span><span class="st">"lambda / nm"</span>, <span class="st">"y--"</span>, line <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>
<span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/axes3d.html" class="external-link">mtext3d</a></span><span class="op">(</span><span class="st">"I / a.u."</span>, edge <span class="op">=</span> <span class="st">"z--"</span>, line <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:rgl-plot-png"></span>
<img src="plotting--fig-3D-01.png" alt="A snapshot of an **rgl** plot.  " width="100%"><p class="caption">
Figure 9.1: A snapshot of an <strong>rgl</strong> plot.
</p>
</div>
<!-- ======================================================================= -->
<!-- ======================================================================= -->
</div>
<div class="section level1">
<h1 id="interactive-plots">
<span class="header-section-number">10</span> Interactive Graphics<a class="anchor" aria-label="anchor" href="#interactive-plots"></a>
</h1>
<p>Package <strong>hyperSpec</strong> offers basic interaction, <code class="sourceCode r"><span class="kw">spc.identify</span>()</code> for spectra plots, and <code class="sourceCode r"><span class="kw">map.identify</span>()</code> and <code class="sourceCode r"><span class="kw">map.sel.poly</span>()</code> for maps.
The first two identify points in spectra plots and map plots, respectively.
Function <code class="sourceCode r"><span class="kw">map.sel.poly</span>()</code> selects the part of a <code class="sourceCode r">hyperSpec</code> object that lies inside the user defined polygon.</p>
<div class="section level2">
<h2 id="sec:spc-identify">
<span class="header-section-number">10.1</span> <code class="sourceCode r"><span class="kw">spc.identify</span>()</code> Finding Out Wavelength, Intensity and Spectrum<a class="anchor" aria-label="anchor" href="#sec:spc-identify"></a>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">spc.identify</span>()</code> allows to measure points in graphics produced by <code class="sourceCode r"><span class="kw">plotspc</span>()</code>.
It works correctly with reversed and cut wavelength axes.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spc_identify.html">spc.identify</a></span><span class="op">(</span><span class="fu"><a href="../reference/plotspc.html">plotspc</a></span><span class="op">(</span><span class="va">paracetamol</span>, wl.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">600</span> <span class="op">~</span> <span class="fl">1800</span>, <span class="fl">2800</span> <span class="op">~</span> <span class="fl">3200</span><span class="op">)</span>, xoffset <span class="op">=</span> <span class="fl">800</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The result is a data.frame with the indices of the spectra, the wavelength, and its intensity.</p>
</div>
<div class="section level2">
<h2 id="sec:map-identify">
<span class="header-section-number">10.2</span> <code class="sourceCode r"><span class="kw">map.identify</span>()</code> finding a spectrum in a map plot<a class="anchor" aria-label="anchor" href="#sec:map-identify"></a>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">map.identify</span>()</code> returns the spectra indices of the clicked points.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/levelplot.html">map.identify</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span>, , <span class="fl">1200</span><span class="op">]</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sec:map-sel-poly">
<span class="header-section-number">10.3</span> <code class="sourceCode r"><span class="kw">map.sel.poly</span>()</code> selecting spectra inside a polygon in a map plot<a class="anchor" aria-label="anchor" href="#sec:map-sel-poly"></a>
</h2>
<p>Function <code class="sourceCode r"><span class="kw">map.sel.poly</span>()</code> returns a logical indicating which spectra are inside the polygon drawn by the user:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/map-sel-poly.html">map.sel.poly</a></span><span class="op">(</span><span class="va">faux_cell</span><span class="op">[</span>, , <span class="fl">1200</span><span class="op">]</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sec:identify-other">
<span class="header-section-number">10.4</span> Related Functions Provided by Base Graphics and <strong><em>lattice</em></strong><a class="anchor" aria-label="anchor" href="#sec:identify-other"></a>
</h2>
<p>For base graphics (as produced by <code class="sourceCode r"><span class="kw">plotspc</span>()</code>), <code class="sourceCode r"><span class="kw">locator</span>()</code> may be useful as well.
It returns the clicked coordinates. Note that these are <em>not</em> transformed according to <code>xoffset</code> &amp; Co.</p>
<p>For lattice graphics, <code class="sourceCode r"><span class="kw">grid.locator</span>()</code> may be used instead.
If it is not called in the panel function, a preceding call to <code class="sourceCode r"><span class="kw">trellis.focus</span>()</code> is needed:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">laser</span>, <span class="st">"mat"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/interaction.html" class="external-link">trellis.focus</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grid/grid.locator.html" class="external-link">grid.locator</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Function <code class="sourceCode r"><span class="kw">identify</span>()</code> (or <code class="sourceCode r"><span class="kw">panel.identify</span>()</code> for lattice graphics) allows to identify points of the plot directly.
Note that the returned indices correspond to the plotted object.</p>
</div>
</div>
<div class="section level1">
<h1 id="sec:troubleshooting">
<span class="header-section-number">11</span> Troubleshooting<a class="anchor" aria-label="anchor" href="#sec:troubleshooting"></a>
</h1>
<div class="section level2">
<h2 id="sec:no-output-produced">
<span class="header-section-number">11.1</span> No Output Is Produced<a class="anchor" aria-label="anchor" href="#sec:no-output-produced"></a>
</h2>
<p>Methods <code class="sourceCode r">plotmap</code>, <code class="sourceCode r">plotvoronoi</code>, <code class="sourceCode r">levelplot</code>, and <code class="sourceCode r">plotc</code> use package <strong>lattice</strong> functions.
Therefore, in loops, functions, Sweave, R Markdown chunks, etc. the lattice object needs to be printed explicitly by <code class="sourceCode r"><span class="kw">print</span>(<span class="kw">plotmap</span>(object))</code>
(<a href="http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-do-lattice_002ftrellis-graphics-not-work_003f" class="external-link">R FAQ: Why do lattice/trellis graphics not work?</a>).
The same holds for package <strong>ggplot2</strong> graphics.</p>
</div>
</div>
<div class="section level1 unnumbered">
<h1 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h1>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="st">"hyperSpec"</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Session info ───────────────────────────────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span>
<span class="co">#&gt;  version  R version 4.1.2 (2021-11-01)</span>
<span class="co">#&gt;  os       macOS Catalina 10.15.7</span>
<span class="co">#&gt;  system   x86_64, darwin17.0</span>
<span class="co">#&gt;  ui       X11</span>
<span class="co">#&gt;  language en</span>
<span class="co">#&gt;  collate  en_US.UTF-8</span>
<span class="co">#&gt;  ctype    en_US.UTF-8</span>
<span class="co">#&gt;  tz       UTC</span>
<span class="co">#&gt;  date     2021-12-13</span>
<span class="co">#&gt;  pandoc   2.7.3 @ /usr/local/bin/ (via rmarkdown)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Packages ───────────────────────────────────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package       </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version     </span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span>
<span class="co">#&gt;  brio             1.1.3        <span style="color: #555555;">2021-11-30</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  callr            3.7.0        <span style="color: #555555;">2021-04-20</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  cli              3.1.0        <span style="color: #555555;">2021-10-27</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  colorspace       2.0-2        <span style="color: #555555;">2021-06-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  crayon           1.4.2        <span style="color: #555555;">2021-10-29</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  desc             1.4.0        <span style="color: #555555;">2021-09-28</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  diffobj          0.3.5        <span style="color: #555555;">2021-10-05</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  digest           0.6.29       <span style="color: #555555;">2021-12-01</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  dplyr            1.0.7        <span style="color: #555555;">2021-06-18</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  ellipsis         0.3.2        <span style="color: #555555;">2021-04-29</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  evaluate         0.14         <span style="color: #555555;">2019-05-28</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  fansi            0.5.0        <span style="color: #555555;">2021-05-25</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  farver           2.1.0        <span style="color: #555555;">2021-02-28</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  generics         0.1.1        <span style="color: #555555;">2021-10-25</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  ggplot2        * 3.3.5        <span style="color: #555555;">2021-06-25</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  glue             1.5.1        <span style="color: #555555;">2021-11-30</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  gtable           0.3.0        <span style="color: #555555;">2019-03-25</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  hyperSpec      * <span style="color: #BB00BB; font-weight: bold;">0.200.0.9000</span> <span style="color: #555555;">2021-12-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">local</span></span>
<span class="co">#&gt;  hySpc.testthat   <span style="color: #BB00BB; font-weight: bold;">0.2.1.9000  </span> <span style="color: #555555;">2021-12-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">local</span></span>
<span class="co">#&gt;  isoband          0.2.5        <span style="color: #555555;">2021-07-13</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  jpeg             0.1-9        <span style="color: #555555;">2021-07-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  jsonlite         1.7.2        <span style="color: #555555;">2020-12-09</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  labeling         0.4.2        <span style="color: #555555;">2020-10-20</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  lattice        * 0.20-45      <span style="color: #555555;">2021-09-22</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.1.2)</span></span>
<span class="co">#&gt;  latticeExtra   * 0.6-29       <span style="color: #555555;">2019-12-19</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  lazyeval         0.2.2        <span style="color: #555555;">2019-03-15</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  lifecycle        1.0.1        <span style="color: #555555;">2021-09-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  magrittr         2.0.1        <span style="color: #555555;">2020-11-17</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  MASS             7.3-54       <span style="color: #555555;">2021-05-03</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.1.2)</span></span>
<span class="co">#&gt;  Matrix           1.3-4        <span style="color: #555555;">2021-06-01</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.1.2)</span></span>
<span class="co">#&gt;  mgcv             1.8-38       <span style="color: #555555;">2021-10-06</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.1.2)</span></span>
<span class="co">#&gt;  munsell          0.5.0        <span style="color: #555555;">2018-06-12</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  nlme             3.1-153      <span style="color: #555555;">2021-09-07</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.1.2)</span></span>
<span class="co">#&gt;  pillar           1.6.4        <span style="color: #555555;">2021-10-18</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  pkgconfig        2.0.3        <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  pkgload          1.2.4        <span style="color: #555555;">2021-11-30</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  png              0.1-7        <span style="color: #555555;">2013-12-03</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  praise           1.0.0        <span style="color: #555555;">2015-08-11</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  processx         3.5.2        <span style="color: #555555;">2021-04-30</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  ps               1.6.0        <span style="color: #555555;">2021-02-28</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  purrr            0.3.4        <span style="color: #555555;">2020-04-17</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  R6               2.5.1        <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  RColorBrewer     1.1-2        <span style="color: #555555;">2014-12-07</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  rematch2         2.1.2        <span style="color: #555555;">2020-05-01</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  rlang            0.4.12       <span style="color: #555555;">2021-10-18</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  rprojroot        2.0.2        <span style="color: #555555;">2020-11-15</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  rstudioapi       0.13         <span style="color: #555555;">2020-11-12</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  scales           1.1.1        <span style="color: #555555;">2020-05-11</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  testthat         3.1.1        <span style="color: #555555;">2021-12-03</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  tibble           3.1.6        <span style="color: #555555;">2021-11-07</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  tidyselect       1.1.1        <span style="color: #555555;">2021-04-30</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  utf8             1.2.2        <span style="color: #555555;">2021-07-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  vctrs            0.3.8        <span style="color: #555555;">2021-04-29</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  viridisLite      0.4.0        <span style="color: #555555;">2021-04-13</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  waldo            0.3.1        <span style="color: #555555;">2021-09-14</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  withr            2.4.3        <span style="color: #555555;">2021-11-30</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt;  xml2             1.3.3        <span style="color: #555555;">2021-11-30</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.1.0)</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;"> [1] /Users/runner/work/_temp/Library</span></span>
<span class="co">#&gt; <span style="color: #555555;"> [2] /Library/Frameworks/R.framework/Versions/4.1/Resources/library</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">──────────────────────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
</div>
<div class="section level1 unnumbered">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<div id="refs" class="references">
<div id="ref-R-tripack">
<p>[1] F. code by R. J. Renka. R functions by Albrecht Gebhardt. With contributions from Stephen Eglen &lt;stephen@anc.ed.ac.uk&gt;, S. Zuyev, D. White, Tripack: Triangulation of irregularly spaced data, 2020. <a href="https://CRAN.R-project.org/package=tripack" class="external-link">https://CRAN.R-project.org/package=tripack</a>.</p>
</div>
<div id="ref-R-lattice">
<p>[2] D. Sarkar, Lattice: Trellis graphics for r, 2021. <a href="http://lattice.r-forge.r-project.org/" class="external-link">http://lattice.r-forge.r-project.org/</a>.</p>
</div>
<div id="ref-lattice2008">
<p>[3] D. Sarkar, Lattice: Multivariate data visualization with r, Springer, New York, 2008. <a href="http://lmdvr.r-forge.r-project.org" class="external-link">http://lmdvr.r-forge.r-project.org</a>.</p>
</div>
<div id="ref-R-plotrix">
<p>[4] J. Lemon, B. Bolker, S. Oom, E. Klein, B. Rowlingson, H. Wickham, A. Tyagi, O. Eterradossi, G. Grothendieck, M. Toews, J. Kane, R. Turner, C. Witthoft, J. Stander, T. Petzoldt, R. Duursma, E. Biancotto, O. Levy, C. Dutang, P. Solymos, R. Engelmann, M. Hecker, F. Steinbeck, H. Borchers, H. Singmann, T. Toal, D. Ogle, D. Baral, U. Groemping, B. Venables, Plotrix: Various plotting functions, 2021. <a href="https://CRAN.R-project.org/package=plotrix" class="external-link">https://CRAN.R-project.org/package=plotrix</a>.</p>
</div>
<div id="ref-plotrix2006">
<p>[5] L. J, Plotrix: A package in the red light district of r, R-News. 6 (2006) 8–12.</p>
</div>
<div id="ref-R-latticeExtra">
<p>[6] D. Sarkar, F. Andrews, LatticeExtra: Extra graphical utilities based on lattice, 2019. <a href="http://latticeextra.r-forge.r-project.org/" class="external-link">http://latticeextra.r-forge.r-project.org/</a>.</p>
</div>
<div id="ref-R-deldir">
<p>[7] R. Turner, Deldir: Delaunay triangulation and dirichlet (voronoi) tessellation, 2021. <a href="https://CRAN.R-project.org/package=deldir" class="external-link">https://CRAN.R-project.org/package=deldir</a>.</p>
</div>
<div id="ref-R-rgl">
<p>[8] D. Adler, D. Murdoch, Rgl: 3D visualization using opengl, 2021. <a href="https://CRAN.R-project.org/package=rgl" class="external-link">https://CRAN.R-project.org/package=rgl</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Claudia Beleites, <a href="https://orcid.org/0000-0002-9500-5167" class="external-link">Vilmantas Gegzna</a>, <a href="http://academic.depauw.edu/hanson_web/" class="external-link">Bryan A. Hanson</a>, Roman Kiselev, Erick Oduniyi, Valter Sergo.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
